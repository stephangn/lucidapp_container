{"ast":null,"code":"import _objectSpread from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from\"react\";import{uploadDokumentHash,getDokumentenhash}from\"../../Web3Client\";import Box from\"@mui/material/Box\";import Stepper from\"@mui/material/Stepper\";import Step from\"@mui/material/Step\";import StepLabel from\"@mui/material/StepLabel\";import Button from\"@mui/material/Button\";import Typography from\"@mui/material/Typography\";import Alert from\"@mui/material/Alert\";import Backdrop from\"@mui/material/Backdrop\";import CircularProgress from\"@mui/material/CircularProgress\";import{MDBInput,MDBFile,MDBBtn,MDBContainer}from\"mdb-react-ui-kit\";import{MDBSpinner}from\"mdb-react-ui-kit\";import useAxiosPrivate from\"../../hooks/useAxiosPrivate\";import{useParams}from\"react-router-dom\";import useAuth from\"../../hooks/useAuth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var steps=[\"Dokument beschreiben\",\"Dokument hochladen\",\"Bestätigen\"];function OtherDocumentsForm(props){var axiosInstance=useAxiosPrivate();var _React$useState=React.useState(\"\"),_React$useState2=_slicedToArray(_React$useState,2),type=_React$useState2[0],setType=_React$useState2[1];var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),description=_React$useState4[0],setDescription=_React$useState4[1];var _React$useState5=React.useState(\"\"),_React$useState6=_slicedToArray(_React$useState5,2),issueDate=_React$useState6[0],setIssueDate=_React$useState6[1];var _React$useState7=React.useState(),_React$useState8=_slicedToArray(_React$useState7,2),fileID=_React$useState8[0],setFileID=_React$useState8[1];var _React$useState9=React.useState(\"\"),_React$useState10=_slicedToArray(_React$useState9,2),fileLink=_React$useState10[0],setFileLink=_React$useState10[1];var _React$useState11=React.useState(0),_React$useState12=_slicedToArray(_React$useState11,2),activeStep=_React$useState12[0],setActiveStep=_React$useState12[1];var _React$useState13=React.useState(new Set()),_React$useState14=_slicedToArray(_React$useState13,2),skipped=_React$useState14[0],setSkipped=_React$useState14[1];var _React$useState15=React.useState(),_React$useState16=_slicedToArray(_React$useState15,2),selectedFile=_React$useState16[0],setSelectedFile=_React$useState16[1];var _React$useState17=React.useState(false),_React$useState18=_slicedToArray(_React$useState17,2),uploadLoading=_React$useState18[0],setUploadLoading=_React$useState18[1];var _React$useState19=React.useState(false),_React$useState20=_slicedToArray(_React$useState19,2),fileUploadSuccess=_React$useState20[0],setFileUploadSuccess=_React$useState20[1];var _useParams=useParams(),transactionId=_useParams.transactionId;var _useState=useState(),_useState2=_slicedToArray(_useState,2),newDocumentData=_useState2[0],setNewDocumentData=_useState2[1];var _useAuth=useAuth(),auth=_useAuth.auth;var newDocumentID;var docformData=new FormData();// -- Loading Backdrop --\nvar _React$useState21=React.useState(false),_React$useState22=_slicedToArray(_React$useState21,2),openBackdrop=_React$useState22[0],setOpenBackdrop=_React$useState22[1];var handleCloseBackdrop=function handleCloseBackdrop(){setOpenBackdrop(false);};var handleToggleBackdrop=function handleToggleBackdrop(){setOpenBackdrop(!openBackdrop);};// Funktion für Datei Upload\nfunction handleUpload(e){e.preventDefault();setUploadLoading(true);var fileformData=new FormData();fileformData.append(\"file\",selectedFile);axiosInstance.post(\"/file/\",fileformData).then(function(res){setFileID(res.data.id);setFileLink(res.data.file);setFileUploadSuccess(true);setUploadLoading(false);}).catch(function(err){return console.log(err.response);});}function uDokumentHash(_x,_x2){return _uDokumentHash.apply(this,arguments);}// DB Upload\nfunction _uDokumentHash(){_uDokumentHash=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_transaktionID,_file){var crypto,fileReader,hashwert;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:crypto=require(\"crypto\");fileReader=new FileReader();hashwert=\"\";fileReader.readAsText(_file);fileReader.onload=function(evt){hashwert=crypto.createHash(\"sha512\").update(evt.target.result).digest(\"hex\");uploadDokumentHash(_transaktionID,hashwert)//Blockchain Transaktion\n.then(function(tx){docformData.append(\"blockchain_id\",tx-1);uploadToDatabase(docformData);return tx;}).catch(function(err){console.log(\"Hashgenerierung fehlgeschlagen. Fehlermeldung: \"+err);// Error-Snackbar setzen\nprops.setSnackbarSuccess(false);props.setSnackbarMessage(\"Fehler bei der Verarbeitung des Dokuments.\");// Backdrop Ladeanimation schließen\nhandleCloseBackdrop();// Snackbar öffnen\nprops.handleOpenSnackbar();// Modal schließen\nprops.toggleAddDocumentModal();});};case 5:case\"end\":return _context.stop();}}},_callee);}));return _uDokumentHash.apply(this,arguments);}function uploadToDatabase(_x3){return _uploadToDatabase.apply(this,arguments);}// Funktion zum Abschicken des Formulars\nfunction _uploadToDatabase(){_uploadToDatabase=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(docformData){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axiosInstance.post(\"/documents/\",docformData).then(function(res){setNewDocumentData(res.data);newDocumentID=res.data.id;console.log(\"Dokument erfolgreich hochgeladen.\");// newDocument -> State aktualisieren\n// newDocument -> State aktualisieren\nprops.setNewDocument(!props.newDocument);// Erfolgs-Snackbar setzen\n// Erfolgs-Snackbar setzen\nprops.setSnackbarSuccess(true);props.setSnackbarMessage(\"Dokument erfolgreich hochgeladen.\");// Backdrop Ladeanimation öffnen\n// Backdrop Ladeanimation öffnen\nhandleToggleBackdrop();// Snackbar öffnen\n// Snackbar öffnen\nprops.handleOpenSnackbar();// Modal schließen\n// Modal schließen\nprops.toggleAddDocumentModal();}).catch(function(err){console.log(err.response);// Error-Snackbar setzen\n// Error-Snackbar setzen\nprops.setSnackbarSuccess(false);props.setSnackbarMessage(\"Fehler beim hochladen des Dokuments.\");// Backdrop Ladeanimation öffnen\n// Backdrop Ladeanimation öffnen\nhandleToggleBackdrop();// Snackbar öffnen\n// Snackbar öffnen\nprops.handleOpenSnackbar();// Modal schließen\n// Modal schließen\nprops.toggleAddDocumentModal();});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return _uploadToDatabase.apply(this,arguments);}function handleSubmit(_x4){return _handleSubmit.apply(this,arguments);}// Alle Funktionen unterhalb: Steuerung des Steppers\n// Kein Step ist optional\nfunction _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var tx,_tx;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0://Standardverhalten abstellen\ne.preventDefault();// Backdrop Ladeanimation öffnen\nhandleToggleBackdrop();docformData.append(\"description\",description);docformData.append(\"type\",type);docformData.append(\"file\",fileID);docformData.append(\"issue_date\",\"2022-03-15\");if(!(transactionId==undefined)){_context3.next=14;break;}console.log(\"Zollmodus mit Transaction ID: \"+props.transactionID_zoll);docformData.append(\"transaction\",props.transactionID_zoll);_context3.next=11;return uDokumentHash(props.transactionID_zoll,selectedFile);case 11:tx=_context3.sent;_context3.next=18;break;case 14:docformData.append(\"transaction\",transactionId);_context3.next=17;return uDokumentHash(transactionId,selectedFile);case 17:_tx=_context3.sent;case 18:case\"end\":return _context3.stop();}}},_callee3);}));return _handleSubmit.apply(this,arguments);}var isStepOptional=function isStepOptional(step){return;};var isStepSkipped=function isStepSkipped(step){return skipped.has(step);};var handleNext=function handleNext(){var newSkipped=skipped;if(isStepSkipped(activeStep)){newSkipped=new Set(newSkipped.values());newSkipped.delete(activeStep);}if(activeStep===0){var forms=document.getElementById(\"documentForm\");if(forms.checkValidity()==false){console.log(\"Formular Eingabe inkorrekt.\");return;}}setActiveStep(function(prevActiveStep){return prevActiveStep+1;});setSkipped(newSkipped);};var handleBack=function handleBack(){setActiveStep(function(prevActiveStep){return prevActiveStep-1;});};var handleSkip=function handleSkip(){if(!isStepOptional(activeStep)){// You probably want to guard against something like this,\n// it should never occur unless someone's actively trying to break something.\nthrow new Error(\"You can't skip a step that isn't optional.\");}setActiveStep(function(prevActiveStep){return prevActiveStep+1;});setSkipped(function(prevSkipped){var newSkipped=new Set(prevSkipped.values());newSkipped.add(activeStep);return newSkipped;});};var handleReset=function handleReset(){setActiveStep(0);};// Wenn Nutzer = Zoll Dokumententyp: \"Zollbescheid\"\nuseEffect(function(){if((props===null||props===void 0?void 0:props.isZoll)==true){setType(\"Zollbescheid\");}},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{sx:{width:\"100%\"},children:[/*#__PURE__*/_jsx(Stepper,{activeStep:activeStep,children:steps.map(function(label,index){var stepProps={};var labelProps={};if(isStepOptional(index)){labelProps.optional=/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:\"Optional\"});}if(isStepSkipped(index)){stepProps.completed=false;}return/*#__PURE__*/_jsx(Step,_objectSpread(_objectSpread({},stepProps),{},{children:/*#__PURE__*/_jsx(StepLabel,_objectSpread(_objectSpread({},labelProps),{},{children:label}))}),label);})}),/*#__PURE__*/_jsx(MDBContainer,{className:\"mt-4\",children:activeStep===steps.length?/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(Typography,{sx:{mt:2,mb:1},children:\"All steps completed - you're finished\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",flexDirection:\"row\",pt:2},children:[/*#__PURE__*/_jsx(Box,{sx:{flex:\"1 1 auto\"}}),/*#__PURE__*/_jsx(Button,{onClick:handleReset,children:\"Zur\\xFCcksetzen\"})]})]}):/*#__PURE__*/_jsxs(React.Fragment,{children:[activeStep===0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"form\",{id:\"documentForm\",onSubmit:function onSubmit(e){return e.preventDefault();},children:[(props===null||props===void 0?void 0:props.isZoll)==true?/*#__PURE__*/_jsx(MDBInput,{className:\"my-4\",value:\"Zollbescheid\",name:\"type\",id:\"documentType\",label:\"Dokumententyp\",disabled:true,onChange:function onChange(e){return setType(e.target.value);},type:\"text\"}):/*#__PURE__*/_jsx(MDBInput,{className:\"my-4\",value:type,name:\"type\",id:\"documentType\",label:\"Dokumententyp\",required:true,onChange:function onChange(e){return setType(e.target.value);},type:\"text\"}),/*#__PURE__*/_jsx(MDBInput,{wrapperClass:\"mb-4\",value:description,textarea:true,name:\"description\",id:\"documentDescription\",rows:3,onChange:function onChange(e){return setDescription(e.target.value);},label:\"Beschreibung (optional)\"})]}),type.toUpperCase()==\"RECHNUNG\"&&/*#__PURE__*/_jsx(\"p\",{className:\"errmsg alert alert-danger\",children:\"Bezeichnung \\\"Rechnung\\\" nicht zul\\xE4ssig. Rechnungsformular verwenden.\"})]}):activeStep===1?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleUpload,children:[/*#__PURE__*/_jsx(MDBFile,{className:\"my-4\",label:\"PDF-Dokument ausw\\xE4hlen\",id:\"customFile\",onChange:function onChange(e){return setSelectedFile(e.target.files[0]);}}),selectedFile===undefined||selectedFile==\"\"?/*#__PURE__*/_jsx(MDBBtn,{disabled:true,type:\"submit\",block:true,children:\"Hochladen\"}):uploadLoading==false?/*#__PURE__*/_jsx(MDBBtn,{type:\"submit\",block:true,children:\"Hochladen\"}):/*#__PURE__*/_jsxs(MDBBtn,{type:\"submit\",block:true,disabled:true,children:[/*#__PURE__*/_jsx(MDBSpinner,{size:\"sm\",role:\"status\",tag:\"span\",className:\"me-2\"}),\"Hochladen...\"]})]}),fileUploadSuccess&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",className:\"mt-4\",children:\"Dokument wurde verarbeitet. Weiter um Upload abzuschlie\\xDFen.\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mt-4\",children:\"Daten best\\xE4tigen:\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Hochgeladene Dokumentenart: \"}),/*#__PURE__*/_jsx(\"br\",{}),type]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Beschreibung: \"}),/*#__PURE__*/_jsx(\"br\",{}),description==\"\"?/*#__PURE__*/_jsx(\"i\",{children:\"Keine Beschreibung.\"}):description]}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"a\",{href:fileLink,target:\"_blank\",rel:\"noopener noreferrer\",children:\"Link zur Datei\"})})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",flexDirection:\"row\",pt:2},children:[/*#__PURE__*/_jsx(Button,{color:\"inherit\",disabled:activeStep===0,onClick:handleBack,sx:{mr:1},children:\"Zur\\xFCck\"}),/*#__PURE__*/_jsx(Box,{sx:{flex:\"1 1 auto\"}}),isStepOptional(activeStep)&&/*#__PURE__*/_jsx(Button,{color:\"inherit\",onClick:handleSkip,sx:{mr:1},children:\"\\xDCberspringen\"}),activeStep===steps.length-1?/*#__PURE__*/_jsx(Button,{onClick:handleSubmit,children:\"Abschicken\"}):activeStep==1&&fileUploadSuccess==false?/*#__PURE__*/_jsx(Button,{disabled:true,onClick:handleNext,children:\"Weiter\"}):activeStep==1&&fileUploadSuccess==true?/*#__PURE__*/_jsx(Button,{onClick:handleNext,children:\"Weiter\"}):/*#__PURE__*/_jsx(Button,{type:\"submit\",form:\"documentForm\",onClick:handleNext,children:\"Weiter\"})]})]})})]}),/*#__PURE__*/_jsx(Backdrop,{sx:{color:\"#fff\",zIndex:function zIndex(theme){return theme.zIndex.drawer+1;}},open:openBackdrop,onClick:handleCloseBackdrop,children:/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\"})})]});}export default OtherDocumentsForm;","map":{"version":3,"sources":["/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/src/components/Documents/OtherDocumentsForm.jsx"],"names":["React","useEffect","useState","uploadDokumentHash","getDokumentenhash","Box","Stepper","Step","StepLabel","Button","Typography","Alert","Backdrop","CircularProgress","MDBInput","MDBFile","MDBBtn","MDBContainer","MDBSpinner","useAxiosPrivate","useParams","useAuth","steps","OtherDocumentsForm","props","axiosInstance","type","setType","description","setDescription","issueDate","setIssueDate","fileID","setFileID","fileLink","setFileLink","activeStep","setActiveStep","Set","skipped","setSkipped","selectedFile","setSelectedFile","uploadLoading","setUploadLoading","fileUploadSuccess","setFileUploadSuccess","transactionId","newDocumentData","setNewDocumentData","auth","newDocumentID","docformData","FormData","openBackdrop","setOpenBackdrop","handleCloseBackdrop","handleToggleBackdrop","handleUpload","e","preventDefault","fileformData","append","post","then","res","data","id","file","catch","err","console","log","response","uDokumentHash","_transaktionID","_file","crypto","require","fileReader","FileReader","hashwert","readAsText","onload","evt","createHash","update","target","result","digest","tx","uploadToDatabase","setSnackbarSuccess","setSnackbarMessage","handleOpenSnackbar","toggleAddDocumentModal","setNewDocument","newDocument","handleSubmit","undefined","transactionID_zoll","isStepOptional","step","isStepSkipped","has","handleNext","newSkipped","values","delete","forms","document","getElementById","checkValidity","prevActiveStep","handleBack","handleSkip","Error","prevSkipped","add","handleReset","isZoll","width","map","label","index","stepProps","labelProps","optional","completed","length","mt","mb","display","flexDirection","pt","flex","value","toUpperCase","files","mr","color","zIndex","theme","drawer"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { uploadDokumentHash, getDokumentenhash } from \"../../Web3Client\";\nimport Box from \"@mui/material/Box\";\nimport Stepper from \"@mui/material/Stepper\";\nimport Step from \"@mui/material/Step\";\nimport StepLabel from \"@mui/material/StepLabel\";\nimport Button from \"@mui/material/Button\";\nimport Typography from \"@mui/material/Typography\";\nimport Alert from \"@mui/material/Alert\";\nimport Backdrop from \"@mui/material/Backdrop\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\n\nimport { MDBInput, MDBFile, MDBBtn, MDBContainer } from \"mdb-react-ui-kit\";\nimport { MDBSpinner } from \"mdb-react-ui-kit\";\nimport useAxiosPrivate from \"../../hooks/useAxiosPrivate\";\nimport { useParams } from \"react-router-dom\";\nimport useAuth from \"../../hooks/useAuth\";\n\nconst steps = [\"Dokument beschreiben\", \"Dokument hochladen\", \"Bestätigen\"];\n\nfunction OtherDocumentsForm(props) {\n  const axiosInstance = useAxiosPrivate();\n\n  const [type, setType] = React.useState(\"\");\n  const [description, setDescription] = React.useState(\"\");\n\n  const [issueDate, setIssueDate] = React.useState(\"\");\n  const [fileID, setFileID] = React.useState();\n\n  const [fileLink, setFileLink] = React.useState(\"\");\n\n  const [activeStep, setActiveStep] = React.useState(0);\n  const [skipped, setSkipped] = React.useState(new Set());\n\n  const [selectedFile, setSelectedFile] = React.useState();\n  const [uploadLoading, setUploadLoading] = React.useState(false);\n  const [fileUploadSuccess, setFileUploadSuccess] = React.useState(false);\n  const { transactionId } = useParams();\n  const [newDocumentData, setNewDocumentData] = useState();\n  const { auth } = useAuth();\n\n  var newDocumentID;\n\n  const docformData = new FormData();\n\n  // -- Loading Backdrop --\n  const [openBackdrop, setOpenBackdrop] = React.useState(false);\n  const handleCloseBackdrop = () => {\n    setOpenBackdrop(false);\n  };\n  const handleToggleBackdrop = () => {\n    setOpenBackdrop(!openBackdrop);\n  };\n\n  // Funktion für Datei Upload\n  function handleUpload(e) {\n    e.preventDefault();\n    setUploadLoading(true);\n    const fileformData = new FormData();\n    fileformData.append(\"file\", selectedFile);\n\n    axiosInstance\n      .post(\"/file/\", fileformData)\n      .then((res) => {\n        setFileID(res.data.id);\n\n        setFileLink(res.data.file);\n        setFileUploadSuccess(true);\n        setUploadLoading(false);\n      })\n      .catch((err) => console.log(err.response));\n  }\n  async function uDokumentHash(_transaktionID, _file) {\n    var crypto = require(\"crypto\");\n    const fileReader = new FileReader();\n    var hashwert = \"\";\n    fileReader.readAsText(_file);\n    fileReader.onload = function (evt) {\n      hashwert = crypto\n        .createHash(\"sha512\")\n        .update(evt.target.result)\n        .digest(\"hex\");\n\n      uploadDokumentHash(_transaktionID, hashwert) //Blockchain Transaktion\n        .then((tx) => {\n          docformData.append(\"blockchain_id\", tx - 1);\n          uploadToDatabase(docformData);\n          return tx;\n        })\n        .catch((err) => {\n          console.log(\"Hashgenerierung fehlgeschlagen. Fehlermeldung: \" + err);\n          // Error-Snackbar setzen\n          props.setSnackbarSuccess(false);\n          props.setSnackbarMessage(\n            \"Fehler bei der Verarbeitung des Dokuments.\"\n          );\n          // Backdrop Ladeanimation schließen\n          handleCloseBackdrop();\n          // Snackbar öffnen\n          props.handleOpenSnackbar();\n          // Modal schließen\n          props.toggleAddDocumentModal();\n        });\n    };\n  }\n\n  // DB Upload\n  async function uploadToDatabase(docformData) {\n    await axiosInstance\n      .post(\"/documents/\", docformData)\n      .then((res) => {\n        setNewDocumentData(res.data);\n        newDocumentID = res.data.id;\n        console.log(\"Dokument erfolgreich hochgeladen.\");\n        // newDocument -> State aktualisieren\n        props.setNewDocument(!props.newDocument);\n        // Erfolgs-Snackbar setzen\n        props.setSnackbarSuccess(true);\n        props.setSnackbarMessage(\"Dokument erfolgreich hochgeladen.\");\n        // Backdrop Ladeanimation öffnen\n        handleToggleBackdrop();\n        // Snackbar öffnen\n        props.handleOpenSnackbar();\n        // Modal schließen\n        props.toggleAddDocumentModal();\n      })\n      .catch((err) => {\n        console.log(err.response);\n        // Error-Snackbar setzen\n        props.setSnackbarSuccess(false);\n        props.setSnackbarMessage(\"Fehler beim hochladen des Dokuments.\");\n        // Backdrop Ladeanimation öffnen\n        handleToggleBackdrop();\n        // Snackbar öffnen\n        props.handleOpenSnackbar();\n        // Modal schließen\n        props.toggleAddDocumentModal();\n      });\n  }\n\n  // Funktion zum Abschicken des Formulars\n  async function handleSubmit(e) {\n    //Standardverhalten abstellen\n    e.preventDefault();\n    // Backdrop Ladeanimation öffnen\n    handleToggleBackdrop();\n    docformData.append(\"description\", description);\n    docformData.append(\"type\", type);\n    docformData.append(\"file\", fileID);\n    docformData.append(\"issue_date\", \"2022-03-15\");\n    if (transactionId == undefined) {\n      console.log(\"Zollmodus mit Transaction ID: \" + props.transactionID_zoll);\n      docformData.append(\"transaction\", props.transactionID_zoll);\n      const tx = await uDokumentHash(props.transactionID_zoll, selectedFile);\n    } else {\n      docformData.append(\"transaction\", transactionId);\n      const tx = await uDokumentHash(transactionId, selectedFile);\n    }\n  }\n\n  // Alle Funktionen unterhalb: Steuerung des Steppers\n\n  // Kein Step ist optional\n  const isStepOptional = (step) => {\n    return;\n  };\n\n  const isStepSkipped = (step) => {\n    return skipped.has(step);\n  };\n\n  const handleNext = () => {\n    let newSkipped = skipped;\n    if (isStepSkipped(activeStep)) {\n      newSkipped = new Set(newSkipped.values());\n      newSkipped.delete(activeStep);\n    }\n\n    if (activeStep === 0) {\n      var forms = document.getElementById(\"documentForm\");\n\n      if (forms.checkValidity() == false) {\n        console.log(\"Formular Eingabe inkorrekt.\");\n        return;\n      }\n    }\n\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\n    setSkipped(newSkipped);\n  };\n\n  const handleBack = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\n  };\n\n  const handleSkip = () => {\n    if (!isStepOptional(activeStep)) {\n      // You probably want to guard against something like this,\n      // it should never occur unless someone's actively trying to break something.\n      throw new Error(\"You can't skip a step that isn't optional.\");\n    }\n\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\n    setSkipped((prevSkipped) => {\n      const newSkipped = new Set(prevSkipped.values());\n      newSkipped.add(activeStep);\n      return newSkipped;\n    });\n  };\n\n  const handleReset = () => {\n    setActiveStep(0);\n  };\n\n  // Wenn Nutzer = Zoll Dokumententyp: \"Zollbescheid\"\n  useEffect(() => {\n    if (props?.isZoll == true) {\n      setType(\"Zollbescheid\");\n    }\n  }, []);\n\n  return (\n    <>\n      <Box sx={{ width: \"100%\" }}>\n        <Stepper activeStep={activeStep}>\n          {steps.map((label, index) => {\n            const stepProps = {};\n            const labelProps = {};\n            if (isStepOptional(index)) {\n              labelProps.optional = (\n                <Typography variant=\"caption\">Optional</Typography>\n              );\n            }\n            if (isStepSkipped(index)) {\n              stepProps.completed = false;\n            }\n            return (\n              <Step key={label} {...stepProps}>\n                <StepLabel {...labelProps}>{label}</StepLabel>\n              </Step>\n            );\n          })}\n        </Stepper>\n        <MDBContainer className=\"mt-4\">\n          {activeStep === steps.length ? (\n            <React.Fragment>\n              <Typography sx={{ mt: 2, mb: 1 }}>\n                All steps completed - you&apos;re finished\n              </Typography>\n              <Box sx={{ display: \"flex\", flexDirection: \"row\", pt: 2 }}>\n                <Box sx={{ flex: \"1 1 auto\" }} />\n                <Button onClick={handleReset}>Zurücksetzen</Button>\n              </Box>\n            </React.Fragment>\n          ) : (\n            <React.Fragment>\n              {activeStep === 0 ? (\n                <>\n                  <form id=\"documentForm\" onSubmit={(e) => e.preventDefault()}>\n                    {props?.isZoll == true ? (\n                      <MDBInput\n                        className=\"my-4\"\n                        value={\"Zollbescheid\"}\n                        name=\"type\"\n                        id=\"documentType\"\n                        label=\"Dokumententyp\"\n                        disabled\n                        onChange={(e) => setType(e.target.value)}\n                        type=\"text\"\n                      />\n                    ) : (\n                      <MDBInput\n                        className=\"my-4\"\n                        value={type}\n                        name=\"type\"\n                        id=\"documentType\"\n                        label=\"Dokumententyp\"\n                        required\n                        onChange={(e) => setType(e.target.value)}\n                        type=\"text\"\n                      />\n                    )}\n\n                    <MDBInput\n                      wrapperClass=\"mb-4\"\n                      value={description}\n                      textarea\n                      name=\"description\"\n                      id=\"documentDescription\"\n                      rows={3}\n                      onChange={(e) => setDescription(e.target.value)}\n                      label=\"Beschreibung (optional)\"\n                    />\n                  </form>\n                  {type.toUpperCase() == \"RECHNUNG\" && (\n                    <p className=\"errmsg alert alert-danger\">\n                      Bezeichnung \"Rechnung\" nicht zulässig. Rechnungsformular\n                      verwenden.\n                    </p>\n                  )}\n                </>\n              ) : activeStep === 1 ? (\n                <>\n                  <form onSubmit={handleUpload}>\n                    <MDBFile\n                      className=\"my-4\"\n                      label=\"PDF-Dokument auswählen\"\n                      id=\"customFile\"\n                      onChange={(e) => setSelectedFile(e.target.files[0])}\n                    />\n                    {selectedFile === undefined || selectedFile == \"\" ? (\n                      <MDBBtn disabled type=\"submit\" block>\n                        Hochladen\n                      </MDBBtn>\n                    ) : uploadLoading == false ? (\n                      <MDBBtn type=\"submit\" block>\n                        Hochladen\n                      </MDBBtn>\n                    ) : (\n                      <MDBBtn type=\"submit\" block disabled>\n                        <MDBSpinner\n                          size=\"sm\"\n                          role=\"status\"\n                          tag=\"span\"\n                          className=\"me-2\"\n                        />\n                        Hochladen...\n                      </MDBBtn>\n                    )}\n                  </form>\n                  {fileUploadSuccess && (\n                    <Alert severity=\"success\" className=\"mt-4\">\n                      Dokument wurde verarbeitet. Weiter um Upload\n                      abzuschließen.\n                    </Alert>\n                  )}\n                </>\n              ) : (\n                <>\n                  <h5 className=\"mt-4\">Daten bestätigen:</h5>\n                  <p>\n                    <b>Hochgeladene Dokumentenart: </b>\n                    <br />\n                    {type}\n                  </p>\n                  <p>\n                    <b>Beschreibung: </b>\n                    <br />\n                    {description == \"\" ? (\n                      <i>Keine Beschreibung.</i>\n                    ) : (\n                      description\n                    )}\n                  </p>\n\n                  <p>\n                    <a\n                      href={fileLink}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                    >\n                      Link zur Datei\n                    </a>\n                  </p>\n                </>\n              )}\n              <Box sx={{ display: \"flex\", flexDirection: \"row\", pt: 2 }}>\n                <Button\n                  color=\"inherit\"\n                  disabled={activeStep === 0}\n                  onClick={handleBack}\n                  sx={{ mr: 1 }}\n                >\n                  Zurück\n                </Button>\n                <Box sx={{ flex: \"1 1 auto\" }} />\n                {isStepOptional(activeStep) && (\n                  <Button color=\"inherit\" onClick={handleSkip} sx={{ mr: 1 }}>\n                    Überspringen\n                  </Button>\n                )}\n\n                {activeStep === steps.length - 1 ? (\n                  <Button onClick={handleSubmit}>Abschicken</Button>\n                ) : activeStep == 1 && fileUploadSuccess == false ? (\n                  <Button disabled onClick={handleNext}>\n                    Weiter\n                  </Button>\n                ) : activeStep == 1 && fileUploadSuccess == true ? (\n                  <Button onClick={handleNext}>Weiter</Button>\n                ) : (\n                  <Button\n                    type=\"submit\"\n                    form=\"documentForm\"\n                    onClick={handleNext}\n                  >\n                    Weiter\n                  </Button>\n                )}\n              </Box>\n            </React.Fragment>\n          )}\n        </MDBContainer>\n      </Box>\n\n      <Backdrop\n        sx={{ color: \"#fff\", zIndex: (theme) => theme.zIndex.drawer + 1 }}\n        open={openBackdrop}\n        onClick={handleCloseBackdrop}\n      >\n        <CircularProgress color=\"inherit\" />\n      </Backdrop>\n    </>\n  );\n}\n\nexport default OtherDocumentsForm;\n"]},"metadata":{},"sourceType":"module"}