{"ast":null,"code":"import Web3 from 'web3';\nimport Zollsystem from './smartcontracts/zollsystem.json';\nlet selectedAccount;\nlet zollsystemcontract;\nlet isinit;\nexport const init = async () => {\n  let provider = window.ethereum;\n\n  if (typeof provider !== 'undefined') {\n    provider.request({\n      method: 'eth_requestAccounts'\n    }).then(accounts => {\n      selectedAccount = accounts[0];\n      console.log(`Selected account is ${selectedAccount}`);\n    }).catch(err => {\n      console.log(err);\n      return;\n    });\n    window.ethereum.on('accountsChanged', function (accounts) {\n      selectedAccount = accounts[0];\n      console.log(`Selected account changed to ${selectedAccount}`);\n    });\n  }\n\n  const web3 = new Web3(provider);\n  const networkId = await web3.eth.net.getId();\n  zollsystemcontract = new web3.eth.Contract(Zollsystem.abi, Zollsystem.networks[networkId].address);\n  isinit = true;\n}; //returns the rechnungID\n\nexport async function createRechnung(_gesamtbetrag, _importeur, _waehrung, _datum, _rechnungsposten) {\n  if (!isinit) {\n    await init();\n  }\n\n  await zollsystemcontract.methods.createRechnung(_gesamtbetrag, _importeur, _waehrung, _datum, _rechnungsposten).send({\n    from: selectedAccount\n  });\n  return await zollsystemcontract.methods.createRechnung(_gesamtbetrag, _importeur, _waehrung, _datum, _rechnungsposten).call({\n    from: selectedAccount\n  });\n}\nexport async function createDokumentHash(_rechnungID, _titel, _hash) {\n  if (!isinit) {\n    await init();\n  }\n\n  await zollsystemcontract.methods.createDokumentHash(_rechnungID, _titel, _hash).send({\n    from: selectedAccount\n  });\n  return await zollsystemcontract.methods.createDokumentHash(_rechnungID, _titel, _hash).call({\n    from: selectedAccount\n  });\n}\nexport async function confirmRechnung(_rechnungID) {\n  if (!isinit) {\n    await init();\n  }\n\n  return zollsystemcontract.methods.confirmRechnung(_rechnungID).send({\n    from: selectedAccount\n  });\n} //returns zollanmeldungID\n\nexport async function createZollanmeldung(_exporteur, _zoll, _rechnungID, _anmelder, _zollgebuehr, _transportkosten) {\n  if (!isinit) {\n    await init();\n  }\n\n  await zollsystemcontract.methods.createZollanmeldung(_exporteur, _zoll, _rechnungID, _anmelder, _zollgebuehr, _transportkosten).send({\n    from: selectedAccount\n  });\n  return await zollsystemcontract.methods.createZollanmeldung(_exporteur, _zoll, _rechnungID, _anmelder, _zollgebuehr, _transportkosten).call({\n    from: selectedAccount\n  });\n}\nexport async function confirmZollanmeldung(_zollanmeldungID) {\n  if (!isinit) {\n    await init();\n  }\n\n  return zollsystemcontract.methods.confirmZollanmeldung(_zollanmeldungID).send({\n    from: selectedAccount\n  });\n}","map":{"version":3,"sources":["/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/src/Web3Client.js"],"names":["Web3","Zollsystem","selectedAccount","zollsystemcontract","isinit","init","provider","window","ethereum","request","method","then","accounts","console","log","catch","err","on","web3","networkId","eth","net","getId","Contract","abi","networks","address","createRechnung","_gesamtbetrag","_importeur","_waehrung","_datum","_rechnungsposten","methods","send","from","call","createDokumentHash","_rechnungID","_titel","_hash","confirmRechnung","createZollanmeldung","_exporteur","_zoll","_anmelder","_zollgebuehr","_transportkosten","confirmZollanmeldung","_zollanmeldungID"],"mappings":"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","sourcesContent":["import Web3 from 'web3';\nimport Zollsystem from './smartcontracts/zollsystem.json';\n\nlet selectedAccount;\n\nlet zollsystemcontract;\n\nlet isinit;\n\nexport const init = async () => {\n    let provider = window.ethereum;\n\n    if (typeof provider !== 'undefined'){\n      provider\n      .request({ method: 'eth_requestAccounts' })\n      .then((accounts) => {\n          selectedAccount = accounts[0];\n        console.log(`Selected account is ${selectedAccount}`);\n      })\n      .catch((err) => {\n        console.log(err);\n        return;\n      });\n      window.ethereum.on('accountsChanged', function (accounts) {\n        selectedAccount = accounts[0];\n        console.log(`Selected account changed to ${selectedAccount}`);\n      });\n    }\n    const web3 = new Web3(provider);\n\n\n\n    const networkId = await web3.eth.net.getId();\n\n    zollsystemcontract = new web3.eth.Contract(\n        Zollsystem.abi, \n        Zollsystem.networks[networkId].address);\n    isinit=true;\n}; \n\n//returns the rechnungID\nexport async function createRechnung(_gesamtbetrag, _importeur, _waehrung, _datum, _rechnungsposten){\n    if (!isinit) {\n        await init();\n    }\n    await zollsystemcontract.methods.createRechnung(_gesamtbetrag, _importeur, _waehrung, _datum, _rechnungsposten).send({from: selectedAccount});\n    return await zollsystemcontract.methods.createRechnung(_gesamtbetrag, _importeur, _waehrung, _datum, _rechnungsposten).call({from: selectedAccount});\n}\n\nexport async function createDokumentHash(_rechnungID, _titel, _hash){\n  if (!isinit) {\n      await init();\n  }\n  await zollsystemcontract.methods.createDokumentHash(_rechnungID, _titel, _hash).send({from: selectedAccount});\n  return await zollsystemcontract.methods.createDokumentHash(_rechnungID, _titel, _hash).call({from: selectedAccount});\n}\n\nexport async function confirmRechnung(_rechnungID){\n  if (!isinit) {\n      await init();\n  }\n  return zollsystemcontract.methods.confirmRechnung(_rechnungID).send({from: selectedAccount});\n}\n\n//returns zollanmeldungID\n export async function createZollanmeldung(_exporteur,  _zoll, _rechnungID, _anmelder, _zollgebuehr, _transportkosten){\n     if (!isinit) {\n         await init();\n     }\n     await zollsystemcontract.methods.createZollanmeldung(_exporteur,  _zoll, _rechnungID, _anmelder, _zollgebuehr, _transportkosten).send({from: selectedAccount});\n     return await zollsystemcontract.methods.createZollanmeldung(_exporteur,  _zoll, _rechnungID, _anmelder, _zollgebuehr, _transportkosten).call({from: selectedAccount});\n }\n\n export async function confirmZollanmeldung(_zollanmeldungID){\n  if (!isinit) {\n      await init();\n  }\n  return zollsystemcontract.methods.confirmZollanmeldung(_zollanmeldungID).send({from: selectedAccount});\n}"]},"metadata":{},"sourceType":"module"}