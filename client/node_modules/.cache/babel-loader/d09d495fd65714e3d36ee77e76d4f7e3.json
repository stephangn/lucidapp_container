{"ast":null,"code":"import _slicedToArray from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{Component,useEffect,useState}from\"react\";import{MDBBtn,MDBCard,MDBCardBody,MDBCardTitle,MDBCardSubTitle,MDBCardText,MDBCol,MDBContainer,MDBRow,MDBIcon,MDBCardFooter,MDBDropdown,MDBDropdownToggle,MDBDropdownMenu,MDBDropdownItem,MDBDropdownLink,MDBModal,MDBModalDialog,MDBModalContent,MDBModalHeader,MDBModalTitle,MDBModalBody,MDBModalFooter,MDBInput,MDBDropdownHeader}from\"mdb-react-ui-kit\";import Inbound from\"../../icons/inbound.png\";import Outbound from\"../../icons/outbound.png\";import{Link}from\"react-router-dom\";import useAuth from\"../../hooks/useAuth\";import useAxiosPrivate from\"../../hooks/useAxiosPrivate\";import MuiAlert from\"@mui/material/Alert\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Transaction(props){var _useAuth=useAuth(),auth=_useAuth.auth;// State: Importeur oder Exporteur\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),isImporteur=_useState2[0],setIsImporteur=_useState2[1];// State: Anzahl Dokumente\nvar _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),numberDocuments=_useState4[0],setNumberDocuments=_useState4[1];// State: Anzahl Rechnungen\nvar _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),numberInvoices=_useState6[0],setNumberInvoices=_useState6[1];var axiosInstance=useAxiosPrivate();// Funktion überprüft ob Importeur oder Exporteur\nuseEffect(function(){if(auth.eori_nr==props.importeur){setIsImporteur(true);}});// Abgleich Anzahl Dokumente für Transaktion\nuseEffect(function(){var documents=props.documentsData;var anzahlDokumente=0;var anzahlRechnungen=0;if(documents.length!==0){for(var i in documents){if(documents[i].transaction==props.id){// Wenn Dokument Transaktion angehört summiere Dokumente\nanzahlDokumente+=1;// Wenn Dokument == Rechnung summmiere Rechnungen\nif(documents[i].type==\"Rechnung\"){anzahlRechnungen+=1;}}}setNumberDocuments(anzahlDokumente);setNumberInvoices(anzahlRechnungen);}},[props.documentsData]);// State: Zollanmeldung vorhanden\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),declarationExists=_useState8[0],setDeclarationExists=_useState8[1];// State: Status Zollanmeldung\nvar _useState9=useState(\"ausstehend\"),_useState10=_slicedToArray(_useState9,2),confirmation=_useState10[0],setConfirmation=_useState10[1];// Prüfen ob Zollanmeldung vorliegt\nuseEffect(function(){var declaration=props.declarationData;var anmeldungVorhanden=false;if(declaration.length!==0){for(var i in declaration){if(declaration[i].transaction==props.id){// Wenn Anmeldung Transaktion angehört setze auf true\nanmeldungVorhanden=true;// Status Zollanmeldung abfragen\nsetConfirmation(declaration[i].status_confirmation);}}setDeclarationExists(anmeldungVorhanden);}},[props.declarationData]);// Delete Modal State\nvar _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),deleteModal=_useState12[0],setDeleteModal=_useState12[1];function toggleShowDeleteModal(){setDeleteModal(!deleteModal);}// Delete-Request an DB\nfunction deleteTransaction(){axiosInstance.delete(\"transactions/\"+props.id+\"/\").then(function(res){console.log(\"Transaktion gelöscht\");}).catch(function(err){console.log(err);});}// Edit Modal State\nvar _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),editModal=_useState14[0],setEditModal=_useState14[1];function toggleShowEditModal(){setEditModal(!editModal);}// In die Funktion Post-Request für aktualisierte Beschreibung\n// Beschreibung ist 'description' ; Transaktions-ID ist 'props.id'\nvar _useState15=useState(props.title),_useState16=_slicedToArray(_useState15,2),description=_useState16[0],setDescription=_useState16[1];// Submit Bearbeitung\nfunction handleEditSubmit(e){e.preventDefault();axiosInstance.patch(\"transactions/\"+props.id+\"/\",{description:description}).then(function(res){console.log(\"Transaktion geändert\");}).catch(function(err){console.log(err);});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(MDBCard,{children:/*#__PURE__*/_jsxs(MDBCardBody,{children:[/*#__PURE__*/_jsxs(MDBContainer,{children:[/*#__PURE__*/_jsxs(MDBCardTitle,{children:[isImporteur?\"Import: \":\"Export: \",props.title,/*#__PURE__*/_jsxs(MDBDropdown,{className:\"float-end\",children:[/*#__PURE__*/_jsx(MDBDropdownToggle,{outline:true,children:/*#__PURE__*/_jsx(MDBIcon,{size:\"lg\",fas:true,icon:\"edit\"})}),declarationExists?/*#__PURE__*/_jsxs(MDBDropdownMenu,{children:[/*#__PURE__*/_jsx(MDBDropdownItem,{children:/*#__PURE__*/_jsxs(MDBDropdownHeader,{children:[\"Zollanmeldung liegt bereits vor. \",/*#__PURE__*/_jsx(\"br\",{}),\" Bearbeitung nicht mehr m\\xF6glich.\"]})}),/*#__PURE__*/_jsx(MDBDropdownItem,{children:/*#__PURE__*/_jsxs(MDBDropdownLink,{className:\"disabled\",onClick:toggleShowEditModal,children:[/*#__PURE__*/_jsx(MDBIcon,{className:\"me-2\",fas:true,icon:\"edit\"}),\"Bearbeiten\"]})}),/*#__PURE__*/_jsx(MDBDropdownItem,{children:/*#__PURE__*/_jsxs(MDBDropdownLink,{className:\"disabled\",onClick:toggleShowDeleteModal,children:[/*#__PURE__*/_jsx(MDBIcon,{className:\"me-2\",fas:true,icon:\"trash-alt\"}),\"L\\xF6schen\"]})})]}):/*#__PURE__*/_jsxs(MDBDropdownMenu,{children:[/*#__PURE__*/_jsx(MDBDropdownItem,{children:/*#__PURE__*/_jsxs(MDBDropdownLink,{onClick:toggleShowEditModal,children:[/*#__PURE__*/_jsx(MDBIcon,{className:\"me-2\",fas:true,icon:\"edit\"}),\"Bearbeiten\"]})}),/*#__PURE__*/_jsx(MDBDropdownItem,{children:/*#__PURE__*/_jsxs(MDBDropdownLink,{onClick:toggleShowDeleteModal,children:[/*#__PURE__*/_jsx(MDBIcon,{className:\"me-2\",fas:true,icon:\"trash-alt\"}),\"L\\xF6schen\"]})})]})]})]}),/*#__PURE__*/_jsxs(MDBCardSubTitle,{children:[\"Hinzugef\\xFCgt am: \",props.added,\" (\",props.timestamp_added.slice(11,19),\")\"]}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsxs(MDBContainer,{children:[/*#__PURE__*/_jsxs(MDBRow,{children:[/*#__PURE__*/_jsx(MDBCol,{sm:\"2\",className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(\"img\",{style:{width:\"100px\",height:\"100px\"},src:isImporteur?Inbound:Outbound})}),/*#__PURE__*/_jsx(MDBCol,{sm:\"5\",children:/*#__PURE__*/_jsxs(MDBCardText,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"b\",{children:[\"Handelspartner\",isImporteur&&\" (Exporteur)\"]}),/*#__PURE__*/_jsx(\"br\",{}),props.exportAddress,/*#__PURE__*/_jsx(\"br\",{}),props.exportStreet,/*#__PURE__*/_jsx(\"br\",{}),props.exportCity,\", \",props.exportCountry]})}),/*#__PURE__*/_jsx(MDBCol,{sm:\"5\",children:/*#__PURE__*/_jsxs(MDBCardText,{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Dokumente insgesamt: \"}),numberDocuments,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"b\",{children:\"Rechnungsdokumente: \"}),numberInvoices,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"b\",{children:\"Zollanmeldung: \"}),declarationExists?\"liegt vor\":\"ausstehend\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"b\",{children:\"Zollbescheid: \"}),confirmation]})})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(MDBRow,{children:[/*#__PURE__*/_jsx(MDBCol,{md:\"8\",lg:\"8\",children:numberInvoices==0?/*#__PURE__*/_jsx(MuiAlert,{severity:\"info\",sx:{my:1},children:\"Transaktion angelegt. Rechnung hochladen, um Zollanmeldung durchf\\xFChren zu k\\xF6nnen.\"}):numberInvoices!==0&&declarationExists==false?/*#__PURE__*/_jsx(MuiAlert,{severity:\"warning\",sx:{my:1},children:\"Rechnung liegt vor. Zollanmeldung ist m\\xF6glich.\"}):declarationExists==true&&confirmation==\"ausstehend\"?/*#__PURE__*/_jsx(MuiAlert,{severity:\"info\",sx:{my:1},children:\"Zollanmeldung abgeschickt. Warte auf Bearbeitung der Zollanmeldung.\"}):confirmation==\"bestätigt\"?/*#__PURE__*/_jsx(MuiAlert,{severity:\"success\",sx:{my:1},children:\"Zollanmeldung angenommen.\"}):confirmation==\"abgelehnt\"?/*#__PURE__*/_jsx(MuiAlert,{severity:\"error\",sx:{my:1},children:\"Zollanmeldung abelehnt.\"}):null}),/*#__PURE__*/_jsx(MDBCol,{md:\"4\",lg:\"4\",children:/*#__PURE__*/_jsx(Link,{style:{display:\"block\",margin:\"1rem 0\"},to:\"/transactions/\"+props.id.toString(),params:{title:\"Hello\"},children:/*#__PURE__*/_jsxs(MDBBtn,{className:\"float-end\",children:[/*#__PURE__*/_jsx(MDBIcon,{size:\"lg\",className:\"me-2\",far:true,icon:\"file\"}),\"Dokumente anzeigen\"]})},props.id)})]})]}),/*#__PURE__*/_jsxs(MDBCardFooter,{children:[\"Zuletzt aktualisiert: \",props.lastChange,\" (\",props.timestamp_processed.slice(11,19),\")\"]})]})}),/*#__PURE__*/_jsx(MDBModal,{show:deleteModal,setShow:setDeleteModal,tabIndex:\"-1\",children:/*#__PURE__*/_jsx(MDBModalDialog,{children:/*#__PURE__*/_jsxs(MDBModalContent,{children:[/*#__PURE__*/_jsxs(MDBModalHeader,{children:[/*#__PURE__*/_jsx(MDBModalTitle,{children:\"Auftrag entfernen\"}),/*#__PURE__*/_jsx(MDBBtn,{className:\"btn-close\",color:\"none\",onClick:toggleShowDeleteModal})]}),/*#__PURE__*/_jsxs(MDBModalBody,{children:[\"Wollen sie den Auftrag \",/*#__PURE__*/_jsxs(\"b\",{children:[\"\\\"\",props.title,\"\\\"\"]}),\" wirklich entfernen? Dieser Vorgang l\\xE4sst sich nicht r\\xFCckg\\xE4ngig machen.\"]}),/*#__PURE__*/_jsxs(MDBModalFooter,{children:[/*#__PURE__*/_jsx(MDBBtn,{color:\"danger\",onClick:toggleShowDeleteModal,children:\"Nicht entfernen\"}),/*#__PURE__*/_jsx(MDBBtn,{outline:true,color:\"danger\",onClick:deleteTransaction,children:\"Entfernen\"})]})]})})}),/*#__PURE__*/_jsx(MDBModal,{show:editModal,setShow:setEditModal,children:/*#__PURE__*/_jsx(MDBModalDialog,{children:/*#__PURE__*/_jsxs(MDBModalContent,{children:[/*#__PURE__*/_jsxs(MDBModalHeader,{children:[/*#__PURE__*/_jsx(MDBModalTitle,{children:\"Auftrag umbenennen\"}),/*#__PURE__*/_jsx(MDBBtn,{className:\"btn-close\",color:\"none\",onClick:toggleShowEditModal})]}),/*#__PURE__*/_jsx(MDBModalBody,{children:/*#__PURE__*/_jsx(MDBContainer,{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleEditSubmit,children:[/*#__PURE__*/_jsx(MDBInput,{name:\"description\",label:\"Beschreibung der Transaktion\",type:\"text\",className:\"mt-2\",onChange:function onChange(e){return setDescription(e.target.value);},value:description}),/*#__PURE__*/_jsx(MDBRow,{children:/*#__PURE__*/_jsx(MDBBtn,{type:\"submit\",color:\"success\",className:\"mt-4 mb-2\",children:\"Speichern\"})})]})})}),/*#__PURE__*/_jsx(MDBModalFooter,{children:/*#__PURE__*/_jsx(MDBBtn,{color:\"danger\",onClick:toggleShowEditModal,children:\"Abbrechen\"})})]})})})]});}export default Transaction;","map":{"version":3,"sources":["/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/src/components/Transactions/Transaction.jsx"],"names":["React","Component","useEffect","useState","MDBBtn","MDBCard","MDBCardBody","MDBCardTitle","MDBCardSubTitle","MDBCardText","MDBCol","MDBContainer","MDBRow","MDBIcon","MDBCardFooter","MDBDropdown","MDBDropdownToggle","MDBDropdownMenu","MDBDropdownItem","MDBDropdownLink","MDBModal","MDBModalDialog","MDBModalContent","MDBModalHeader","MDBModalTitle","MDBModalBody","MDBModalFooter","MDBInput","MDBDropdownHeader","Inbound","Outbound","Link","useAuth","useAxiosPrivate","MuiAlert","Transaction","props","auth","isImporteur","setIsImporteur","numberDocuments","setNumberDocuments","numberInvoices","setNumberInvoices","axiosInstance","eori_nr","importeur","documents","documentsData","anzahlDokumente","anzahlRechnungen","length","i","transaction","id","type","declarationExists","setDeclarationExists","confirmation","setConfirmation","declaration","declarationData","anmeldungVorhanden","status_confirmation","deleteModal","setDeleteModal","toggleShowDeleteModal","deleteTransaction","delete","then","res","console","log","catch","err","editModal","setEditModal","toggleShowEditModal","title","description","setDescription","handleEditSubmit","e","preventDefault","patch","added","timestamp_added","slice","width","height","exportAddress","exportStreet","exportCity","exportCountry","my","display","margin","toString","lastChange","timestamp_processed","target","value"],"mappings":"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","sourcesContent":["import React, { Component, useEffect, useState } from \"react\";\nimport {\n  MDBBtn,\n  MDBCard,\n  MDBCardBody,\n  MDBCardTitle,\n  MDBCardSubTitle,\n  MDBCardText,\n  MDBCol,\n  MDBContainer,\n  MDBRow,\n  MDBIcon,\n  MDBCardFooter,\n  MDBDropdown,\n  MDBDropdownToggle,\n  MDBDropdownMenu,\n  MDBDropdownItem,\n  MDBDropdownLink,\n  MDBModal,\n  MDBModalDialog,\n  MDBModalContent,\n  MDBModalHeader,\n  MDBModalTitle,\n  MDBModalBody,\n  MDBModalFooter,\n  MDBInput,\n  MDBDropdownHeader,\n} from \"mdb-react-ui-kit\";\nimport Inbound from \"../../icons/inbound.png\";\nimport Outbound from \"../../icons/outbound.png\";\n\nimport { Link } from \"react-router-dom\";\nimport useAuth from \"../../hooks/useAuth\";\nimport useAxiosPrivate from \"../../hooks/useAxiosPrivate\";\n\nimport MuiAlert from \"@mui/material/Alert\";\n\nfunction Transaction(props) {\n  const { auth } = useAuth();\n\n  // State: Importeur oder Exporteur\n  const [isImporteur, setIsImporteur] = useState(false);\n\n  // State: Anzahl Dokumente\n  const [numberDocuments, setNumberDocuments] = useState(0);\n\n  // State: Anzahl Rechnungen\n  const [numberInvoices, setNumberInvoices] = useState(0);\n\n  const axiosInstance = useAxiosPrivate();\n\n  // Funktion überprüft ob Importeur oder Exporteur\n  useEffect(() => {\n    if (auth.eori_nr == props.importeur) {\n      setIsImporteur(true);\n    }\n  });\n\n  // Abgleich Anzahl Dokumente für Transaktion\n  useEffect(() => {\n    let documents = props.documentsData;\n    let anzahlDokumente = 0;\n    let anzahlRechnungen = 0;\n    if (documents.length !== 0) {\n      for (let i in documents) {\n        if (documents[i].transaction == props.id) {\n          // Wenn Dokument Transaktion angehört summiere Dokumente\n          anzahlDokumente += 1;\n          // Wenn Dokument == Rechnung summmiere Rechnungen\n          if (documents[i].type == \"Rechnung\") {\n            anzahlRechnungen += 1;\n          }\n        }\n      }\n      setNumberDocuments(anzahlDokumente);\n      setNumberInvoices(anzahlRechnungen);\n    }\n  }, [props.documentsData]);\n\n  // State: Zollanmeldung vorhanden\n  const [declarationExists, setDeclarationExists] = useState(false);\n  // State: Status Zollanmeldung\n  const [confirmation, setConfirmation] = useState(\"ausstehend\");\n\n  // Prüfen ob Zollanmeldung vorliegt\n  useEffect(() => {\n    let declaration = props.declarationData;\n    let anmeldungVorhanden = false;\n    if (declaration.length !== 0) {\n      for (let i in declaration) {\n        if (declaration[i].transaction == props.id) {\n          // Wenn Anmeldung Transaktion angehört setze auf true\n          anmeldungVorhanden = true;\n          // Status Zollanmeldung abfragen\n          setConfirmation(declaration[i].status_confirmation);\n        }\n      }\n      setDeclarationExists(anmeldungVorhanden);\n    }\n  }, [props.declarationData]);\n\n  // Delete Modal State\n  const [deleteModal, setDeleteModal] = useState(false);\n\n  function toggleShowDeleteModal() {\n    setDeleteModal(!deleteModal);\n  }\n\n  // Delete-Request an DB\n\n  function deleteTransaction() {\n    axiosInstance\n      .delete(\"transactions/\" + props.id + \"/\")\n      .then((res) => {\n        console.log(\"Transaktion gelöscht\");\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  // Edit Modal State\n  const [editModal, setEditModal] = useState(false);\n\n  function toggleShowEditModal() {\n    setEditModal(!editModal);\n  }\n\n  // In die Funktion Post-Request für aktualisierte Beschreibung\n  // Beschreibung ist 'description' ; Transaktions-ID ist 'props.id'\n  const [description, setDescription] = useState(props.title);\n\n  // Submit Bearbeitung\n  function handleEditSubmit(e) {\n    e.preventDefault();\n\n    axiosInstance\n      .patch(\"transactions/\" + props.id + \"/\", { description: description })\n      .then((res) => {\n        console.log(\"Transaktion geändert\");\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  return (\n    <div>\n      <MDBCard>\n        <MDBCardBody>\n          <MDBContainer>\n            <MDBCardTitle>\n              {isImporteur ? \"Import: \" : \"Export: \"}\n              {props.title}\n              {/* <MDBIcon className=\"float-end\" size=\"lg\" fas icon=\"ellipsis-h\" /> */}\n              <MDBDropdown className=\"float-end\">\n                <MDBDropdownToggle outline>\n                  <MDBIcon size=\"lg\" fas icon=\"edit\" />\n                </MDBDropdownToggle>\n                {declarationExists ? (\n                  <MDBDropdownMenu>\n                    <MDBDropdownItem>\n                      <MDBDropdownHeader>\n                        Zollanmeldung liegt bereits vor. <br /> Bearbeitung\n                        nicht mehr möglich.\n                      </MDBDropdownHeader>\n                    </MDBDropdownItem>\n                    <MDBDropdownItem>\n                      <MDBDropdownLink\n                        className=\"disabled\"\n                        onClick={toggleShowEditModal}\n                      >\n                        <MDBIcon className=\"me-2\" fas icon=\"edit\" />\n                        Bearbeiten\n                      </MDBDropdownLink>\n                    </MDBDropdownItem>\n                    <MDBDropdownItem>\n                      <MDBDropdownLink\n                        className=\"disabled\"\n                        onClick={toggleShowDeleteModal}\n                      >\n                        <MDBIcon className=\"me-2\" fas icon=\"trash-alt\" />\n                        Löschen\n                      </MDBDropdownLink>\n                    </MDBDropdownItem>\n                  </MDBDropdownMenu>\n                ) : (\n                  <MDBDropdownMenu>\n                    <MDBDropdownItem>\n                      <MDBDropdownLink onClick={toggleShowEditModal}>\n                        <MDBIcon className=\"me-2\" fas icon=\"edit\" />\n                        Bearbeiten\n                      </MDBDropdownLink>\n                    </MDBDropdownItem>\n                    <MDBDropdownItem>\n                      <MDBDropdownLink onClick={toggleShowDeleteModal}>\n                        <MDBIcon className=\"me-2\" fas icon=\"trash-alt\" />\n                        Löschen\n                      </MDBDropdownLink>\n                    </MDBDropdownItem>\n                  </MDBDropdownMenu>\n                )}\n              </MDBDropdown>\n            </MDBCardTitle>\n\n            <MDBCardSubTitle>\n              Hinzugefügt am: {props.added} (\n              {props.timestamp_added.slice(11, 19)})\n            </MDBCardSubTitle>\n            <br />\n          </MDBContainer>\n          <MDBContainer>\n            <MDBRow>\n              <MDBCol sm=\"2\" className=\"d-flex justify-content-center\">\n                <img\n                  style={{ width: \"100px\", height: \"100px\" }}\n                  src={isImporteur ? Inbound : Outbound}\n                />\n\n                {/* <MDBIcon fas icon=\"clipboard-list\" size=\"4x\" className=\"mt-3\" /> */}\n              </MDBCol>\n              <MDBCol sm=\"5\">\n                <MDBCardText className=\"mb-3\">\n                  <b>Handelspartner{isImporteur && \" (Exporteur)\"}</b>\n                  <br />\n                  {props.exportAddress}\n                  <br />\n                  {props.exportStreet}\n                  <br />\n                  {props.exportCity}, {props.exportCountry}\n                </MDBCardText>\n              </MDBCol>\n              <MDBCol sm=\"5\">\n                <MDBCardText className=\"mb-2\">\n                  <b>Dokumente insgesamt: </b>\n                  {numberDocuments}\n                  <br />\n                  <b>Rechnungsdokumente: </b>\n                  {numberInvoices}\n                  <br />\n                  <b>Zollanmeldung: </b>\n                  {declarationExists ? \"liegt vor\" : \"ausstehend\"}\n                  <br />\n                  <b>Zollbescheid: </b>\n                  {confirmation}\n                </MDBCardText>\n              </MDBCol>\n            </MDBRow>\n            <br />\n            <MDBRow>\n              <MDBCol md=\"8\" lg=\"8\">\n                {numberInvoices == 0 ? (\n                  <MuiAlert severity=\"info\" sx={{ my: 1 }}>\n                    Transaktion angelegt. Rechnung hochladen, um Zollanmeldung\n                    durchführen zu können.\n                  </MuiAlert>\n                ) : numberInvoices !== 0 && declarationExists == false ? (\n                  <MuiAlert severity=\"warning\" sx={{ my: 1 }}>\n                    Rechnung liegt vor. Zollanmeldung ist möglich.\n                  </MuiAlert>\n                ) : declarationExists == true &&\n                  confirmation == \"ausstehend\" ? (\n                  <MuiAlert severity=\"info\" sx={{ my: 1 }}>\n                    Zollanmeldung abgeschickt. Warte auf Bearbeitung der\n                    Zollanmeldung.\n                  </MuiAlert>\n                ) : confirmation == \"bestätigt\" ? (\n                  <MuiAlert severity=\"success\" sx={{ my: 1 }}>\n                    Zollanmeldung angenommen.\n                  </MuiAlert>\n                ) : confirmation == \"abgelehnt\" ? (\n                  <MuiAlert severity=\"error\" sx={{ my: 1 }}>\n                    Zollanmeldung abelehnt.\n                  </MuiAlert>\n                ) : null}\n              </MDBCol>\n              <MDBCol md=\"4\" lg=\"4\">\n                <Link\n                  style={{ display: \"block\", margin: \"1rem 0\" }}\n                  to={\"/transactions/\" + props.id.toString()}\n                  key={props.id}\n                  params={{ title: \"Hello\" }}\n                >\n                  <MDBBtn className=\"float-end\">\n                    <MDBIcon size=\"lg\" className=\"me-2\" far icon=\"file\" />\n                    Dokumente anzeigen\n                  </MDBBtn>\n                </Link>\n              </MDBCol>\n            </MDBRow>\n          </MDBContainer>\n          <MDBCardFooter>\n            Zuletzt aktualisiert: {props.lastChange} (\n            {props.timestamp_processed.slice(11, 19)})\n          </MDBCardFooter>\n        </MDBCardBody>\n      </MDBCard>\n\n      {/* Delete Modal */}\n      <MDBModal show={deleteModal} setShow={setDeleteModal} tabIndex=\"-1\">\n        <MDBModalDialog>\n          <MDBModalContent>\n            <MDBModalHeader>\n              <MDBModalTitle>Auftrag entfernen</MDBModalTitle>\n              <MDBBtn\n                className=\"btn-close\"\n                color=\"none\"\n                onClick={toggleShowDeleteModal}\n              ></MDBBtn>\n            </MDBModalHeader>\n            <MDBModalBody>\n              Wollen sie den Auftrag <b>\"{props.title}\"</b> wirklich entfernen?\n              Dieser Vorgang lässt sich nicht rückgängig machen.\n            </MDBModalBody>\n\n            <MDBModalFooter>\n              <MDBBtn color=\"danger\" onClick={toggleShowDeleteModal}>\n                Nicht entfernen\n              </MDBBtn>\n              <MDBBtn outline color=\"danger\" onClick={deleteTransaction}>\n                Entfernen\n              </MDBBtn>\n            </MDBModalFooter>\n          </MDBModalContent>\n        </MDBModalDialog>\n      </MDBModal>\n\n      {/* Edit Modal */}\n      <MDBModal show={editModal} setShow={setEditModal}>\n        <MDBModalDialog>\n          <MDBModalContent>\n            <MDBModalHeader>\n              <MDBModalTitle>Auftrag umbenennen</MDBModalTitle>\n              <MDBBtn\n                className=\"btn-close\"\n                color=\"none\"\n                onClick={toggleShowEditModal}\n              ></MDBBtn>\n            </MDBModalHeader>\n            <MDBModalBody>\n              <MDBContainer>\n                <form onSubmit={handleEditSubmit}>\n                  <MDBInput\n                    name=\"description\"\n                    label=\"Beschreibung der Transaktion\"\n                    type=\"text\"\n                    className=\"mt-2\"\n                    onChange={(e) => setDescription(e.target.value)}\n                    value={description}\n                  />\n                  <MDBRow>\n                    <MDBBtn type=\"submit\" color=\"success\" className=\"mt-4 mb-2\">\n                      Speichern\n                    </MDBBtn>\n                  </MDBRow>\n                </form>\n              </MDBContainer>\n            </MDBModalBody>\n\n            <MDBModalFooter>\n              <MDBBtn color=\"danger\" onClick={toggleShowEditModal}>\n                Abbrechen\n              </MDBBtn>\n            </MDBModalFooter>\n          </MDBModalContent>\n        </MDBModalDialog>\n      </MDBModal>\n    </div>\n  );\n}\n\nexport default Transaction;\n"]},"metadata":{},"sourceType":"module"}