{"ast":null,"code":"import _asyncToGenerator from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect}from\"react\";import\"./css/LoadingSpinner.css\";import{MDBContainer,MDBCol,MDBRow,MDBSpinner}from\"mdb-react-ui-kit\";import Snackbar from\"@mui/material/Snackbar\";import MuiAlert from\"@mui/material/Alert\";import Transaction from\"../components/Transactions/Transaction\";import{useParams}from\"react-router-dom\";import TransactionModal from\"../components/Transactions/TransactionModal\";import Form from\"react-bootstrap/Form\";import{useLocation}from\"react-router-dom\";import useAxiosPrivate from\"../hooks/useAxiosPrivate\";// Snackbar-Alert\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Alert=/*#__PURE__*/React.forwardRef(function Alert(props,ref){return/*#__PURE__*/_jsx(MuiAlert,_objectSpread({elevation:6,ref:ref,variant:\"filled\"},props));});function Transactions(){var _partnership$partner;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),transactionsData=_useState2[0],setTransactionsData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),documentsData=_useState4[0],setDocumentsData=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),declarationData=_useState6[0],setDeclarationData=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loaded=_useState8[0],setLoaded=_useState8[1];// Reload-State: DB-Call wird mittels useEffect wiederholt, sobald\n// ein neuer Auftrag hinzugefügt wurde\nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),reload=_useState10[0],setreload=_useState10[1];// State für Ladeanimation\nvar _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),isLoading=_useState12[0],setIsLoading=_useState12[1];var axiosInstance=useAxiosPrivate();var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isFilterView=_useState14[0],setIsFilterView=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),partnership=_useState16[0],setPartnership=_useState16[1];var _useParams=useParams(),partnershipID=_useParams.partnershipID;var location=useLocation();// DB Call\nuseEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var link;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!partnershipID){_context.next=7;break;}link=\"transactions/?partnership=\"+partnershipID;setIsFilterView(true);_context.next=5;return axiosInstance.get(\"partnership/\"+partnershipID+\"/\").then(function(res){setPartnership(res.data);});case 5:_context.next=9;break;case 7:link=\"transactions/\";setIsFilterView(false);case 9:axiosInstance.get(link).then(function(res){// Daten werden erst sortiert nach \"dateUpdatedDesc\"\n// und danach im State gespeichert\nvar initialSort=[].concat(res.data).sort(function(a,b){return a.timestamp_added>b.timestamp_added?-1:1;});setTransactionsData(initialSort);});setIsLoading(false);case 11:case\"end\":return _context.stop();}}},_callee);})),[reload,location]);// Dokumente abrufen\nuseEffect(function(){axiosInstance.get(\"documents/\").then(function(res){setDocumentsData(res.data);});},[]);// Zollanmeldungen abrufen\nuseEffect(function(){axiosInstance.get(\"declaration/\").then(function(res){setDeclarationData(res.data);});},[]);// Sortieralgorithmen\nfunction sortDescriptionAsc(){var myData=[].concat(transactionsData).sort(function(a,b){return a.description.toUpperCase()>b.description.toUpperCase()?-1:1;});setTransactionsData(myData);}function sortDescriptionDesc(){var myData=[].concat(transactionsData).sort(function(a,b){return a.description.toUpperCase()>b.description.toUpperCase()?1:-1;});setTransactionsData(myData);}function sortDateAddedAsc(){var myData=[].concat(transactionsData).sort(function(a,b){return a.timestamp_added>b.timestamp_added?1:-1;});setTransactionsData(myData);}function sortDateAddedDesc(){var myData=[].concat(transactionsData).sort(function(a,b){return a.timestamp_added>b.timestamp_added?-1:1;});setTransactionsData(myData);}function sortDateUpdatedAsc(){var myData=[].concat(transactionsData).sort(function(a,b){return a.timestamp_processed>b.timestamp_processed?1:-1;});setTransactionsData(myData);}function sortDateUpdatedDesc(){var myData=[].concat(transactionsData).sort(function(a,b){return a.timestamp_processed>b.timestamp_processed?-1:1;});setTransactionsData(myData);}function sortTransactions(event){if(event.target.value===\"DescriptionAsc\"){sortDescriptionAsc();return;}if(event.target.value===\"DescriptionDesc\"){sortDescriptionDesc();return;}if(event.target.value===\"UpdatedAsc\"){sortDateUpdatedAsc();return;}if(event.target.value===\"UpdatedDesc\"){sortDateUpdatedDesc();return;}if(event.target.value===\"AddedAsc\"){sortDateAddedAsc();return;}if(event.target.value===\"AddedDesc\"){sortDateAddedDesc();return;}}// Snackbar-Alert Rückmeldung\n// State: Geöffnet (true) / Geschlossen (false)\nvar _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),openSnackbar=_useState18[0],setOpenSnackbar=_useState18[1];// State: Succcess (true) / Error (false)\nvar _useState19=useState(true),_useState20=_slicedToArray(_useState19,2),snackbarSuccess=_useState20[0],setSnackbarSuccess=_useState20[1];// State: Snackbar Nachricht\nvar _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),snackbarMessage=_useState22[0],setSnackbarMessage=_useState22[1];// Öffnen der Snackbar\nvar handleOpenSnackbar=function handleOpenSnackbar(){setOpenSnackbar(true);};// Schließen der Snackbar\nvar handleCloseSnackbar=function handleCloseSnackbar(event,reason){if(reason===\"clickaway\"){return;}setOpenSnackbar(false);};return/*#__PURE__*/_jsx(_Fragment,{children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"loadingSpinner\",children:/*#__PURE__*/_jsx(MDBSpinner,{children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"L\\xE4dt..\"})})}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(MDBContainer,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Auftr\\xE4ge\"}),isFilterView&&/*#__PURE__*/_jsxs(\"h4\",{children:[\"Daten sind gefiltert \",partnership===null||partnership===void 0?void 0:(_partnership$partner=partnership.partner)===null||_partnership$partner===void 0?void 0:_partnership$partner.name]}),/*#__PURE__*/_jsx(\"nav\",{className:\"my-3 navbar navbar-expand-lg navbar-light bg-light\",children:/*#__PURE__*/_jsxs(MDBContainer,{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(MDBRow,{children:[/*#__PURE__*/_jsxs(MDBCol,{children:[/*#__PURE__*/_jsxs(Form.Select,{style:{width:270},className:\"me-3\",onChange:function onChange(event){return sortTransactions(event);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"UpdatedDesc\",children:\"Zuletzt ge\\xE4ndert absteigend \\uD83E\\uDC17\"}),/*#__PURE__*/_jsx(\"option\",{value:\"UpdatedAsc\",children:\"Zuletzt ge\\xE4ndert aufsteigend \\uD83E\\uDC15\"}),/*#__PURE__*/_jsx(\"option\",{value:\"DescriptionDesc\",children:\"Beschreibung absteigend \\uD83E\\uDC17\"}),/*#__PURE__*/_jsx(\"option\",{value:\"DescriptionAsc\",children:\"Beschreibung aufsteigend \\uD83E\\uDC15\"}),/*#__PURE__*/_jsx(\"option\",{value:\"AddedDesc\",children:\"Hinzugef\\xFCgt am absteigend \\uD83E\\uDC17\"}),/*#__PURE__*/_jsx(\"option\",{value:\"AddedAsc\",children:\"Hinzugef\\xFCgt am aufsteigend \\uD83E\\uDC15\"})]}),\" \"]}),/*#__PURE__*/_jsx(MDBCol,{children:/*#__PURE__*/_jsx(\"div\",{className:\"mt-2\",children:/*#__PURE__*/_jsxs(\"b\",{children:[transactionsData.length,\" Auftr\\xE4ge\"]})})})]})}),/*#__PURE__*/_jsx(TransactionModal,{setreload:setreload,reload:reload,handleOpenSnackbar:handleOpenSnackbar,handleCloseSnackbar:handleCloseSnackbar,setSnackbarSuccess:setSnackbarSuccess,setSnackbarMessage:setSnackbarMessage})]})}),transactionsData.map(function(transactionData){return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(Transaction,{id:transactionData.id,title:transactionData.description,added:transactionData.date_added,exportAddress:transactionData.partnership.partner.name,exportStreet:transactionData.partnership.partner.street,exportCity:transactionData.partnership.partner.city,exportCountry:transactionData.partnership.partner.country_code,importAddress:transactionData.importAddress,importStreet:transactionData.importStreet,importCity:transactionData.importCity,importCountry:transactionData.importCountry,stakeholderCount:transactionData.stakeholderCount,lastChange:transactionData.date_processed,status:transactionData.status,importeur:transactionData.importeur,timestamp_added:transactionData.timestamp_added,timestamp_processed:transactionData.timestamp_processed,documentsData:documentsData,declarationData:declarationData},transactionData.id),/*#__PURE__*/_jsx(\"br\",{})]});})]}),/*#__PURE__*/_jsx(Snackbar,{anchorOrigin:{vertical:\"top\",horizontal:\"right\"},open:openSnackbar,autoHideDuration:6000,onClose:handleCloseSnackbar,className:\"mt-5\",children:snackbarSuccess==true?/*#__PURE__*/_jsx(Alert,{onClose:handleCloseSnackbar,severity:\"success\",sx:{width:\"100%\"},children:snackbarMessage}):/*#__PURE__*/_jsx(Alert,{onClose:handleCloseSnackbar,severity:\"error\",sx:{width:\"100%\"},children:snackbarMessage})})]})});}export default Transactions;","map":{"version":3,"sources":["/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/src/pages/Transactions.jsx"],"names":["React","useState","useEffect","MDBContainer","MDBCol","MDBRow","MDBSpinner","Snackbar","MuiAlert","Transaction","useParams","TransactionModal","Form","useLocation","useAxiosPrivate","Alert","forwardRef","props","ref","Transactions","transactionsData","setTransactionsData","documentsData","setDocumentsData","declarationData","setDeclarationData","loaded","setLoaded","reload","setreload","isLoading","setIsLoading","axiosInstance","isFilterView","setIsFilterView","partnership","setPartnership","partnershipID","location","link","get","then","res","data","initialSort","concat","sort","a","b","timestamp_added","sortDescriptionAsc","myData","description","toUpperCase","sortDescriptionDesc","sortDateAddedAsc","sortDateAddedDesc","sortDateUpdatedAsc","timestamp_processed","sortDateUpdatedDesc","sortTransactions","event","target","value","openSnackbar","setOpenSnackbar","snackbarSuccess","setSnackbarSuccess","snackbarMessage","setSnackbarMessage","handleOpenSnackbar","handleCloseSnackbar","reason","partner","name","width","length","map","transactionData","id","date_added","street","city","country_code","importAddress","importStreet","importCity","importCountry","stakeholderCount","date_processed","status","importeur","vertical","horizontal"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"./css/LoadingSpinner.css\";\nimport { MDBContainer, MDBCol, MDBRow, MDBSpinner } from \"mdb-react-ui-kit\";\nimport Snackbar from \"@mui/material/Snackbar\";\nimport MuiAlert from \"@mui/material/Alert\";\nimport Transaction from \"../components/Transactions/Transaction\";\nimport { useParams } from \"react-router-dom\";\nimport TransactionModal from \"../components/Transactions/TransactionModal\";\nimport Form from \"react-bootstrap/Form\";\nimport { useLocation } from \"react-router-dom\";\n\nimport useAxiosPrivate from \"../hooks/useAxiosPrivate\";\n\n// Snackbar-Alert\nconst Alert = React.forwardRef(function Alert(props, ref) {\n  return <MuiAlert elevation={6} ref={ref} variant=\"filled\" {...props} />;\n});\n\nfunction Transactions() {\n  const [transactionsData, setTransactionsData] = useState([]);\n  const [documentsData, setDocumentsData] = useState([]);\n  const [declarationData, setDeclarationData] = useState([]);\n  const [loaded, setLoaded] = useState(false);\n  // Reload-State: DB-Call wird mittels useEffect wiederholt, sobald\n  // ein neuer Auftrag hinzugefügt wurde\n  const [reload, setreload] = useState(false);\n\n  // State für Ladeanimation\n  const [isLoading, setIsLoading] = useState(true);\n\n  const axiosInstance = useAxiosPrivate();\n  const [isFilterView, setIsFilterView] = useState(false);\n  const [partnership, setPartnership] = useState();\n\n  const { partnershipID } = useParams();\n  let location = useLocation();\n\n  // DB Call\n  useEffect(async () => {\n    var link;\n    if (partnershipID) {\n      link = \"transactions/?partnership=\" + partnershipID;\n      setIsFilterView(true);\n      await axiosInstance\n        .get(\"partnership/\" + partnershipID + \"/\")\n        .then((res) => {\n          setPartnership(res.data);\n        });\n    } else {\n      link = \"transactions/\";\n      setIsFilterView(false);\n    }\n    axiosInstance.get(link).then((res) => {\n      // Daten werden erst sortiert nach \"dateUpdatedDesc\"\n      // und danach im State gespeichert\n      const initialSort = []\n        .concat(res.data)\n        .sort((a, b) => (a.timestamp_added > b.timestamp_added ? -1 : 1));\n      setTransactionsData(initialSort);\n    });\n    setIsLoading(false);\n  }, [reload, location]);\n\n  // Dokumente abrufen\n  useEffect(() => {\n    axiosInstance.get(\"documents/\").then((res) => {\n      setDocumentsData(res.data);\n    });\n  }, []);\n\n  // Zollanmeldungen abrufen\n  useEffect(() => {\n    axiosInstance.get(\"declaration/\").then((res) => {\n      setDeclarationData(res.data);\n    });\n  }, []);\n\n  // Sortieralgorithmen\n  function sortDescriptionAsc() {\n    const myData = []\n      .concat(transactionsData)\n      .sort((a, b) =>\n        a.description.toUpperCase() > b.description.toUpperCase() ? -1 : 1\n      );\n\n    setTransactionsData(myData);\n  }\n\n  function sortDescriptionDesc() {\n    const myData = []\n      .concat(transactionsData)\n      .sort((a, b) =>\n        a.description.toUpperCase() > b.description.toUpperCase() ? 1 : -1\n      );\n\n    setTransactionsData(myData);\n  }\n\n  function sortDateAddedAsc() {\n    const myData = []\n      .concat(transactionsData)\n      .sort((a, b) => (a.timestamp_added > b.timestamp_added ? 1 : -1));\n\n    setTransactionsData(myData);\n  }\n\n  function sortDateAddedDesc() {\n    const myData = []\n      .concat(transactionsData)\n      .sort((a, b) => (a.timestamp_added > b.timestamp_added ? -1 : 1));\n\n    setTransactionsData(myData);\n  }\n\n  function sortDateUpdatedAsc() {\n    const myData = []\n      .concat(transactionsData)\n      .sort((a, b) => (a.timestamp_processed > b.timestamp_processed ? 1 : -1));\n\n    setTransactionsData(myData);\n  }\n\n  function sortDateUpdatedDesc() {\n    const myData = []\n      .concat(transactionsData)\n      .sort((a, b) => (a.timestamp_processed > b.timestamp_processed ? -1 : 1));\n\n    setTransactionsData(myData);\n  }\n\n  function sortTransactions(event) {\n    if (event.target.value === \"DescriptionAsc\") {\n      sortDescriptionAsc();\n      return;\n    }\n    if (event.target.value === \"DescriptionDesc\") {\n      sortDescriptionDesc();\n      return;\n    }\n    if (event.target.value === \"UpdatedAsc\") {\n      sortDateUpdatedAsc();\n      return;\n    }\n    if (event.target.value === \"UpdatedDesc\") {\n      sortDateUpdatedDesc();\n      return;\n    }\n    if (event.target.value === \"AddedAsc\") {\n      sortDateAddedAsc();\n      return;\n    }\n    if (event.target.value === \"AddedDesc\") {\n      sortDateAddedDesc();\n      return;\n    }\n  }\n\n  // Snackbar-Alert Rückmeldung\n  // State: Geöffnet (true) / Geschlossen (false)\n  const [openSnackbar, setOpenSnackbar] = useState(false);\n  // State: Succcess (true) / Error (false)\n  const [snackbarSuccess, setSnackbarSuccess] = useState(true);\n  // State: Snackbar Nachricht\n  const [snackbarMessage, setSnackbarMessage] = useState(\"\");\n\n  // Öffnen der Snackbar\n  const handleOpenSnackbar = () => {\n    setOpenSnackbar(true);\n  };\n\n  // Schließen der Snackbar\n  const handleCloseSnackbar = (event, reason) => {\n    if (reason === \"clickaway\") {\n      return;\n    }\n\n    setOpenSnackbar(false);\n  };\n\n  return (\n    <>\n      {isLoading ? (\n        <div className=\"loadingSpinner\">\n          <MDBSpinner>\n            <span className=\"visually-hidden\">Lädt..</span>\n          </MDBSpinner>\n        </div>\n      ) : (\n        <div>\n          <MDBContainer>\n            <h3>Aufträge</h3>\n            {isFilterView && (\n              <h4>Daten sind gefiltert {partnership?.partner?.name}</h4>\n            )}\n\n            <nav className=\"my-3 navbar navbar-expand-lg navbar-light bg-light\">\n              <MDBContainer>\n                <div>\n                  <MDBRow>\n                    <MDBCol>\n                      <Form.Select\n                        style={{\n                          width: 270,\n                        }}\n                        className=\"me-3\"\n                        onChange={(event) => sortTransactions(event)}\n                      >\n                        <option value={\"UpdatedDesc\"}>\n                          Zuletzt geändert absteigend &#129047;\n                        </option>\n                        <option value={\"UpdatedAsc\"}>\n                          Zuletzt geändert aufsteigend &#129045;\n                        </option>\n                        <option value={\"DescriptionDesc\"}>\n                          Beschreibung absteigend &#129047;\n                        </option>\n                        <option value={\"DescriptionAsc\"}>\n                          Beschreibung aufsteigend &#129045;\n                        </option>\n                        <option value={\"AddedDesc\"}>\n                          Hinzugefügt am absteigend &#129047;\n                        </option>\n                        <option value={\"AddedAsc\"}>\n                          Hinzugefügt am aufsteigend &#129045;\n                        </option>\n                      </Form.Select>{\" \"}\n                    </MDBCol>\n                    <MDBCol>\n                      <div className=\"mt-2\">\n                        <b>{transactionsData.length} Aufträge</b>\n                      </div>\n                    </MDBCol>\n                  </MDBRow>\n                </div>\n                <TransactionModal\n                  setreload={setreload}\n                  reload={reload}\n                  handleOpenSnackbar={handleOpenSnackbar}\n                  handleCloseSnackbar={handleCloseSnackbar}\n                  setSnackbarSuccess={setSnackbarSuccess}\n                  setSnackbarMessage={setSnackbarMessage}\n                />\n              </MDBContainer>\n            </nav>\n            {transactionsData.map((transactionData) => (\n              <React.Fragment>\n                <Transaction\n                  key={transactionData.id}\n                  id={transactionData.id}\n                  title={transactionData.description}\n                  added={transactionData.date_added}\n                  exportAddress={transactionData.partnership.partner.name}\n                  exportStreet={transactionData.partnership.partner.street}\n                  exportCity={transactionData.partnership.partner.city}\n                  exportCountry={\n                    transactionData.partnership.partner.country_code\n                  }\n                  importAddress={transactionData.importAddress}\n                  importStreet={transactionData.importStreet}\n                  importCity={transactionData.importCity}\n                  importCountry={transactionData.importCountry}\n                  stakeholderCount={transactionData.stakeholderCount}\n                  lastChange={transactionData.date_processed}\n                  status={transactionData.status}\n                  importeur={transactionData.importeur}\n                  timestamp_added={transactionData.timestamp_added}\n                  timestamp_processed={transactionData.timestamp_processed}\n                  documentsData={documentsData}\n                  declarationData={declarationData}\n                />\n                <br />\n              </React.Fragment>\n            ))}\n          </MDBContainer>\n          <Snackbar\n            anchorOrigin={{ vertical: \"top\", horizontal: \"right\" }}\n            open={openSnackbar}\n            autoHideDuration={6000}\n            onClose={handleCloseSnackbar}\n            className=\"mt-5\"\n          >\n            {snackbarSuccess == true ? (\n              <Alert\n                onClose={handleCloseSnackbar}\n                severity=\"success\"\n                sx={{ width: \"100%\" }}\n              >\n                {snackbarMessage}\n              </Alert>\n            ) : (\n              <Alert\n                onClose={handleCloseSnackbar}\n                severity=\"error\"\n                sx={{ width: \"100%\" }}\n              >\n                {snackbarMessage}\n              </Alert>\n            )}\n          </Snackbar>\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default Transactions;\n"]},"metadata":{},"sourceType":"module"}