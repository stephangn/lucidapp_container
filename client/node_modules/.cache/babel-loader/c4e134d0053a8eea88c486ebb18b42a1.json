{"ast":null,"code":"import _asyncToGenerator from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import useAxiosPrivate from\"../../hooks/useAxiosPrivate\";import{Link}from\"react-router-dom\";import\"../css/LoadingSpinner.css\";import{MDBContainer,MDBBtn,MDBRow,MDBCol,MDBSpinner,MDBBadge}from\"mdb-react-ui-kit\";import{MDBBreadcrumb,MDBBreadcrumbItem}from\"mdb-react-ui-kit\";import Divider from\"@mui/material/Divider\";import Backdrop from\"@mui/material/Backdrop\";import CircularProgress from\"@mui/material/CircularProgress\";import{Snackbar}from\"@mui/material\";import MuiAlert from\"@mui/material/Alert\";import ZollDocumentsModal from\"../../components/ZollDocuments/ZollDocumentsModal\";import ZollDocumentTransaction from\"../../components/ZollDocuments/ZollDocumentTransaction\";import DocumentCard from\"../../components/Documents/DocumentCard\";import DeclarationCard from\"../../components/Documents/DeclarationCard\";// Snackbar Alert\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Alert=/*#__PURE__*/React.forwardRef(function Alert(props,ref){return/*#__PURE__*/_jsx(MuiAlert,_objectSpread({elevation:6,ref:ref,variant:\"filled\"},props));});function ZollDocuments(props){// Allgemeine Auftragsinformationen\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),transactionData=_useState2[0],setTransactionData=_useState2[1];// Informationen der hochgeladenen Dokumente\nvar _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),documentsData=_useState4[0],setDocumentsData=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),declarationData=_useState6[0],setDeclarationData=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),totalValue=_useState10[0],setTotalValue=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),invoiceData=_useState12[0],setInvoiceData=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isVerified=_useState14[0],setIsVerified=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),open=_useState16[0],setOpen=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),reload=_useState18[0],setReload=_useState18[1];var axiosInstance=useAxiosPrivate();// Speichern der Transaktions-ID aus URL\nvar _useParams=useParams(),declarationID=_useParams.declarationID;useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axiosInstance.get(\"declaration_auth/\"+declarationID).then(function(res){setDeclarationData(res.data);setDocumentsData(res.data.document);setTransactionData(res.data.transaction);axiosInstance.get(\"invoice/\"+res.data.invoice.id+\"/\").then(function(res){setTotalValue(res.data.total_value);setInvoiceData(res.data);});}).catch(function(err){console.log(\"Keine Zollanmeldung liegt vor\"+err);});case 2:setIsLoading(false);case 3:case\"end\":return _context.stop();}}},_callee);})),[reload]);// State für \"Dokument hinzufügen\" Modal\nvar _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),addDocumentModal=_useState20[0],setAddDocumentModal=_useState20[1];// Funktion für Manipulation von Modal (als props weitergereicht)\nfunction toggleAddDocumentModal(){setAddDocumentModal(!addDocumentModal);}// Anzahl Rechnungs+Zolldokumente call(a) und sonstige Dokumente call(b)\nfunction numberInvoiceDocuments(alternative){var invoiceAndCustoms=0;var other=0;for(var i=0;i<documentsData.length;i++){if(documentsData[i].type==\"Rechnung\"){invoiceAndCustoms+=1;}else{other+=1;}}if(alternative==\"a\"){return invoiceAndCustoms;}if(alternative==\"b\"){return other;}return;}// -- Loading Backdrop --\nvar _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),openBackdrop=_React$useState2[0],setOpenBackdrop=_React$useState2[1];var handleCloseBackdrop=function handleCloseBackdrop(){setOpenBackdrop(false);};var handleToggleBackdrop=function handleToggleBackdrop(){setOpenBackdrop(!openBackdrop);};// -- Snackbar-Alert Rückmeldung --\n// State: Geöffnet (true) / Geschlossen (false)\nvar _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),openSnackbar=_useState22[0],setOpenSnackbar=_useState22[1];// State: Succcess (true) / Error (false)\nvar _useState23=useState(true),_useState24=_slicedToArray(_useState23,2),snackbarSuccess=_useState24[0],setSnackbarSuccess=_useState24[1];// State: Snackbar Nachricht\nvar _useState25=useState(\"\"),_useState26=_slicedToArray(_useState25,2),snackbarMessage=_useState26[0],setSnackbarMessage=_useState26[1];// Öffnen der Snackbar\nvar handleOpenSnackbar=function handleOpenSnackbar(){setOpenSnackbar(true);};// Schließen der Snackbar\nvar handleCloseSnackbar=function handleCloseSnackbar(event,reason){if(reason===\"clickaway\"){return;}setOpenSnackbar(false);};return/*#__PURE__*/_jsx(_Fragment,{children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"loadingSpinner\",children:/*#__PURE__*/_jsx(MDBSpinner,{children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"L\\xE4dt..\"})})}):/*#__PURE__*/_jsxs(MDBContainer,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Zollanmeldung Dokumente\"}),/*#__PURE__*/_jsx(ZollDocumentsModal,{basicModal:addDocumentModal,setBasicModal:setAddDocumentModal,toggleShow:toggleAddDocumentModal,transactionData:transactionData,setSnackbarSuccess:setSnackbarSuccess,setSnackbarMessage:setSnackbarMessage,handleOpenSnackbar:handleOpenSnackbar,handleCloseSnackbar:handleCloseSnackbar,transactionID_zoll:declarationData.transaction.id,reload:reload,setReload:setReload}),/*#__PURE__*/_jsxs(MDBBreadcrumb,{children:[/*#__PURE__*/_jsx(MDBBreadcrumbItem,{children:/*#__PURE__*/_jsx(Link,{to:\"/zoll/declarations\",children:\"Auftr\\xE4ge\"})}),/*#__PURE__*/_jsxs(MDBBreadcrumbItem,{active:true,children:[\"Zollanmeldung-ID \",declarationData.id]})]}),/*#__PURE__*/_jsx(ZollDocumentTransaction,{declarationData:declarationData,numberDocuments:documentsData===null||documentsData===void 0?void 0:documentsData.length,gesamtbetrag:totalValue,invoiceData:invoiceData,setIsVerified:setIsVerified,isVerified:isVerified,setOpen:setOpen,handleToggleBackdrop:handleToggleBackdrop,handleCloseBackdrop:handleCloseBackdrop,handleOpenSnackbar:handleOpenSnackbar,handleCloseSnackbar:handleCloseSnackbar,setSnackbarSuccess:setSnackbarSuccess,setSnackbarMessage:setSnackbarMessage,reload:reload,setReload:setReload}),/*#__PURE__*/_jsx(\"nav\",{className:\"my-3 navbar navbar-expand-lg navbar-light bg-light\",children:/*#__PURE__*/_jsxs(MDBContainer,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(MDBBadge,{pill:true,className:\"ms-3\",children:1}),\" \",/*#__PURE__*/_jsx(\"b\",{children:\"Zollanmeldung\"}),/*#__PURE__*/_jsx(MDBBadge,{pill:true,className:\"ms-3\",children:1}),\" \",/*#__PURE__*/_jsx(\"b\",{children:\"Rechnungsdokument\"}),/*#__PURE__*/_jsx(MDBBadge,{pill:true,className:\"ms-3\",children:numberInvoiceDocuments(\"b\")}),\" \",/*#__PURE__*/_jsx(\"b\",{children:\"Sonstige Dokumente\"})]}),/*#__PURE__*/_jsx(MDBBtn,{className:\"float-end\",color:\"success\",onClick:toggleAddDocumentModal,children:\"Zollbescheid hochladen\"})]})}),/*#__PURE__*/_jsx(Divider,{textAlign:\"left\",className:\"my-4\",children:/*#__PURE__*/_jsx(\"h5\",{children:\"Zollanmeldung\"})}),/*#__PURE__*/_jsx(MDBRow,{children:/*#__PURE__*/_jsx(DeclarationCard,{anmeldeArt:declarationData.anmeldeArt,gesamtbetrag:totalValue,waehrung:declarationData.invoice.currency,bearbeitendeDienststelle:declarationData.customs_office.name,lieferkosten:declarationData.invoice.transport_costs,documentId:documentsData.documentId,anmelderName:declarationData.importeur.name,issue_date:declarationData.date_added})}),/*#__PURE__*/_jsx(Divider,{textAlign:\"left\",className:\"my-4\",children:/*#__PURE__*/_jsx(\"h5\",{children:\"Rechnungsdokument\"})}),/*#__PURE__*/_jsx(MDBRow,{children:/*#__PURE__*/_jsx(MDBCol,{className:\"mb-4 d-flex justify-content-center\",children:/*#__PURE__*/_jsx(DocumentCard,{id:declarationData.invoice.id,author_company:declarationData.exporteur.name,author:\"Karl Company\",type:\"Rechnung\",description:declarationData.invoice.description,documentDate:declarationData.invoice.issue_date,uploadDate:declarationData.invoice.upload_date,file:declarationData.invoice.file,isZoll:true},declarationData.invoice.id)})}),numberInvoiceDocuments(\"b\")!==0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Divider,{textAlign:\"left\",className:\"mt-5 mb-4\",children:/*#__PURE__*/_jsx(\"h5\",{children:\"Sonstige Dokumente\"})}),/*#__PURE__*/_jsx(MDBRow,{children:documentsData.map(function(documentData){return documentData.type!==\"Rechnung\"&&/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(MDBCol,{className:\"mb-4 d-flex justify-content-center\",children:/*#__PURE__*/_jsx(DocumentCard,{id:documentData.id,author:documentData.author,type:documentData.type,description:documentData.description,documentDate:documentData.issue_date,uploadDate:documentData.upload_date,file:documentData.file,confirmed:documentData.confirmed,isZoll:true,blockchain_did:documentData.blockchain_id},documentData.id)})});})})]}),/*#__PURE__*/_jsx(Backdrop,{sx:{color:\"#fff\",zIndex:function zIndex(theme){return theme.zIndex.drawer+1;}},open:openBackdrop,onClick:handleCloseBackdrop,children:/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\"})}),/*#__PURE__*/_jsx(Snackbar,{anchorOrigin:{vertical:\"top\",horizontal:\"right\"},open:openSnackbar,autoHideDuration:6000,onClose:handleCloseSnackbar,className:\"mt-5\",children:snackbarSuccess==true?/*#__PURE__*/_jsx(Alert,{onClose:handleCloseSnackbar,severity:\"success\",sx:{width:\"100%\"},children:snackbarMessage}):/*#__PURE__*/_jsx(Alert,{onClose:handleCloseSnackbar,severity:\"error\",sx:{width:\"100%\"},children:snackbarMessage})})]})});}export default ZollDocuments;","map":{"version":3,"sources":["/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/src/pages/Zoll/ZollDocuments.jsx"],"names":["React","useEffect","useState","useParams","useAxiosPrivate","Link","MDBContainer","MDBBtn","MDBRow","MDBCol","MDBSpinner","MDBBadge","MDBBreadcrumb","MDBBreadcrumbItem","Divider","Backdrop","CircularProgress","Snackbar","MuiAlert","ZollDocumentsModal","ZollDocumentTransaction","DocumentCard","DeclarationCard","Alert","forwardRef","props","ref","ZollDocuments","transactionData","setTransactionData","documentsData","setDocumentsData","declarationData","setDeclarationData","isLoading","setIsLoading","totalValue","setTotalValue","invoiceData","setInvoiceData","isVerified","setIsVerified","open","setOpen","reload","setReload","axiosInstance","declarationID","get","then","res","data","document","transaction","invoice","id","total_value","catch","err","console","log","addDocumentModal","setAddDocumentModal","toggleAddDocumentModal","numberInvoiceDocuments","alternative","invoiceAndCustoms","other","i","length","type","openBackdrop","setOpenBackdrop","handleCloseBackdrop","handleToggleBackdrop","openSnackbar","setOpenSnackbar","snackbarSuccess","setSnackbarSuccess","snackbarMessage","setSnackbarMessage","handleOpenSnackbar","handleCloseSnackbar","event","reason","anmeldeArt","currency","customs_office","name","transport_costs","documentId","importeur","date_added","exporteur","description","issue_date","upload_date","file","map","documentData","author","confirmed","blockchain_id","color","zIndex","theme","drawer","vertical","horizontal","width"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport useAxiosPrivate from \"../../hooks/useAxiosPrivate\";\nimport { Link } from \"react-router-dom\";\nimport \"../css/LoadingSpinner.css\";\nimport {\n  MDBContainer,\n  MDBBtn,\n  MDBRow,\n  MDBCol,\n  MDBSpinner,\n  MDBBadge,\n} from \"mdb-react-ui-kit\";\nimport { MDBBreadcrumb, MDBBreadcrumbItem } from \"mdb-react-ui-kit\";\n\nimport Divider from \"@mui/material/Divider\";\nimport Backdrop from \"@mui/material/Backdrop\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\nimport { Snackbar } from \"@mui/material\";\nimport MuiAlert from \"@mui/material/Alert\";\n\nimport ZollDocumentsModal from \"../../components/ZollDocuments/ZollDocumentsModal\";\nimport ZollDocumentTransaction from \"../../components/ZollDocuments/ZollDocumentTransaction\";\nimport DocumentCard from \"../../components/Documents/DocumentCard\";\nimport DeclarationCard from \"../../components/Documents/DeclarationCard\";\n\n// Snackbar Alert\nconst Alert = React.forwardRef(function Alert(props, ref) {\n  return <MuiAlert elevation={6} ref={ref} variant=\"filled\" {...props} />;\n});\n\nfunction ZollDocuments(props) {\n  // Allgemeine Auftragsinformationen\n  const [transactionData, setTransactionData] = useState([]);\n\n  // Informationen der hochgeladenen Dokumente\n  const [documentsData, setDocumentsData] = useState([]);\n  const [declarationData, setDeclarationData] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [totalValue, setTotalValue] = useState(true);\n  const [invoiceData, setInvoiceData] = useState();\n  const [isVerified, setIsVerified] = useState(false);\n  const [open, setOpen] = useState(false);\n\n  const [reload, setReload] = useState(false);\n\n  const axiosInstance = useAxiosPrivate();\n\n  // Speichern der Transaktions-ID aus URL\n  const { declarationID } = useParams();\n\n  useEffect(async () => {\n    await axiosInstance\n      .get(`declaration_auth/` + declarationID)\n      .then((res) => {\n        setDeclarationData(res.data);\n        setDocumentsData(res.data.document);\n        setTransactionData(res.data.transaction);\n        axiosInstance\n          .get(\"invoice/\" + res.data.invoice.id + \"/\")\n          .then((res) => {\n            setTotalValue(res.data.total_value);\n\n            setInvoiceData(res.data);\n          });\n      })\n      .catch((err) => {\n        console.log(\"Keine Zollanmeldung liegt vor\" + err);\n      });\n\n    setIsLoading(false);\n  }, [reload]);\n\n  // State für \"Dokument hinzufügen\" Modal\n  const [addDocumentModal, setAddDocumentModal] = useState(false);\n  // Funktion für Manipulation von Modal (als props weitergereicht)\n  function toggleAddDocumentModal() {\n    setAddDocumentModal(!addDocumentModal);\n  }\n\n  // Anzahl Rechnungs+Zolldokumente call(a) und sonstige Dokumente call(b)\n  function numberInvoiceDocuments(alternative) {\n    let invoiceAndCustoms = 0;\n    let other = 0;\n    for (let i = 0; i < documentsData.length; i++) {\n      if (documentsData[i].type == \"Rechnung\") {\n        invoiceAndCustoms += 1;\n      } else {\n        other += 1;\n      }\n    }\n    if (alternative == \"a\") {\n      return invoiceAndCustoms;\n    }\n    if (alternative == \"b\") {\n      return other;\n    }\n    return;\n  }\n\n  // -- Loading Backdrop --\n  const [openBackdrop, setOpenBackdrop] = React.useState(false);\n  const handleCloseBackdrop = () => {\n    setOpenBackdrop(false);\n  };\n  const handleToggleBackdrop = () => {\n    setOpenBackdrop(!openBackdrop);\n  };\n\n  // -- Snackbar-Alert Rückmeldung --\n  // State: Geöffnet (true) / Geschlossen (false)\n  const [openSnackbar, setOpenSnackbar] = useState(false);\n  // State: Succcess (true) / Error (false)\n  const [snackbarSuccess, setSnackbarSuccess] = useState(true);\n  // State: Snackbar Nachricht\n  const [snackbarMessage, setSnackbarMessage] = useState(\"\");\n\n  // Öffnen der Snackbar\n  const handleOpenSnackbar = () => {\n    setOpenSnackbar(true);\n  };\n\n  // Schließen der Snackbar\n  const handleCloseSnackbar = (event, reason) => {\n    if (reason === \"clickaway\") {\n      return;\n    }\n\n    setOpenSnackbar(false);\n  };\n\n  return (\n    <>\n      {isLoading ? (\n        <div className=\"loadingSpinner\">\n          <MDBSpinner>\n            <span className=\"visually-hidden\">Lädt..</span>\n          </MDBSpinner>\n        </div>\n      ) : (\n        <MDBContainer>\n          <h3>Zollanmeldung Dokumente</h3>\n          <ZollDocumentsModal\n            basicModal={addDocumentModal}\n            setBasicModal={setAddDocumentModal}\n            toggleShow={toggleAddDocumentModal}\n            transactionData={transactionData}\n            setSnackbarSuccess={setSnackbarSuccess}\n            setSnackbarMessage={setSnackbarMessage}\n            handleOpenSnackbar={handleOpenSnackbar}\n            handleCloseSnackbar={handleCloseSnackbar}\n            transactionID_zoll={declarationData.transaction.id}\n            reload={reload}\n            setReload={setReload}\n          />\n          <MDBBreadcrumb>\n            <MDBBreadcrumbItem>\n              <Link to=\"/zoll/declarations\">Aufträge</Link>\n            </MDBBreadcrumbItem>\n            <MDBBreadcrumbItem active>\n              Zollanmeldung-ID {declarationData.id}\n            </MDBBreadcrumbItem>\n          </MDBBreadcrumb>\n          <ZollDocumentTransaction\n            declarationData={declarationData}\n            numberDocuments={documentsData?.length}\n            gesamtbetrag={totalValue}\n            invoiceData={invoiceData}\n            setIsVerified={setIsVerified}\n            isVerified={isVerified}\n            setOpen={setOpen}\n            handleToggleBackdrop={handleToggleBackdrop}\n            handleCloseBackdrop={handleCloseBackdrop}\n            handleOpenSnackbar={handleOpenSnackbar}\n            handleCloseSnackbar={handleCloseSnackbar}\n            setSnackbarSuccess={setSnackbarSuccess}\n            setSnackbarMessage={setSnackbarMessage}\n            reload={reload}\n            setReload={setReload}\n          />\n\n          {/* Navleiste mit Anzahl der Dokumente */}\n          <nav className=\"my-3 navbar navbar-expand-lg navbar-light bg-light\">\n            <MDBContainer>\n              <div>\n                <MDBBadge pill className=\"ms-3\">\n                  {1}\n                </MDBBadge>{\" \"}\n                <b>Zollanmeldung</b>\n                <MDBBadge pill className=\"ms-3\">\n                  {1}\n                </MDBBadge>{\" \"}\n                <b>Rechnungsdokument</b>\n                <MDBBadge pill className=\"ms-3\">\n                  {numberInvoiceDocuments(\"b\")}\n                </MDBBadge>{\" \"}\n                <b>Sonstige Dokumente</b>\n              </div>\n              <MDBBtn\n                className=\"float-end\"\n                color=\"success\"\n                onClick={toggleAddDocumentModal}\n              >\n                Zollbescheid hochladen\n              </MDBBtn>\n            </MDBContainer>\n          </nav>\n          {/* Auflistung der Rechnungsdokumente */}\n          <Divider textAlign=\"left\" className=\"my-4\">\n            <h5>Zollanmeldung</h5>\n          </Divider>\n          <MDBRow>\n            <DeclarationCard\n              anmeldeArt={declarationData.anmeldeArt}\n              gesamtbetrag={totalValue}\n              waehrung={declarationData.invoice.currency}\n              bearbeitendeDienststelle={declarationData.customs_office.name}\n              lieferkosten={declarationData.invoice.transport_costs}\n              documentId={documentsData.documentId}\n              anmelderName={declarationData.importeur.name}\n              issue_date={declarationData.date_added}\n            />\n          </MDBRow>\n          <Divider textAlign=\"left\" className=\"my-4\">\n            <h5>Rechnungsdokument</h5>\n          </Divider>\n          <MDBRow>\n            <MDBCol className=\"mb-4 d-flex justify-content-center\">\n              <DocumentCard\n                key={declarationData.invoice.id}\n                id={declarationData.invoice.id}\n                author_company={declarationData.exporteur.name}\n                author=\"Karl Company\"\n                type=\"Rechnung\"\n                description={declarationData.invoice.description}\n                documentDate={declarationData.invoice.issue_date}\n                uploadDate={declarationData.invoice.upload_date}\n                file={declarationData.invoice.file}\n                isZoll={true}\n              />\n            </MDBCol>\n          </MDBRow>\n\n          {/* Auflistung der sonstigen Dokumente */}\n          {numberInvoiceDocuments(\"b\") !== 0 && (\n            <>\n              <Divider textAlign=\"left\" className=\"mt-5 mb-4\">\n                <h5>Sonstige Dokumente</h5>\n              </Divider>\n              <MDBRow>\n                {documentsData.map(\n                  (documentData) =>\n                    documentData.type !== \"Rechnung\" && (\n                      <React.Fragment>\n                        <MDBCol className=\"mb-4 d-flex justify-content-center\">\n                          <DocumentCard\n                            key={documentData.id}\n                            id={documentData.id}\n                            author={documentData.author}\n                            type={documentData.type}\n                            description={documentData.description}\n                            documentDate={documentData.issue_date}\n                            uploadDate={documentData.upload_date}\n                            file={documentData.file}\n                            confirmed={documentData.confirmed}\n                            isZoll={true}\n                            blockchain_did={documentData.blockchain_id}\n                          />\n                        </MDBCol>\n                      </React.Fragment>\n                    )\n                )}\n              </MDBRow>\n            </>\n          )}\n\n          {/* Loading Backddrop */}\n          <Backdrop\n            sx={{ color: \"#fff\", zIndex: (theme) => theme.zIndex.drawer + 1 }}\n            open={openBackdrop}\n            onClick={handleCloseBackdrop}\n          >\n            <CircularProgress color=\"inherit\" />\n          </Backdrop>\n          {/* Snackbar */}\n          <Snackbar\n            anchorOrigin={{ vertical: \"top\", horizontal: \"right\" }}\n            open={openSnackbar}\n            autoHideDuration={6000}\n            onClose={handleCloseSnackbar}\n            className=\"mt-5\"\n          >\n            {snackbarSuccess == true ? (\n              <Alert\n                onClose={handleCloseSnackbar}\n                severity=\"success\"\n                sx={{ width: \"100%\" }}\n              >\n                {snackbarMessage}\n              </Alert>\n            ) : (\n              <Alert\n                onClose={handleCloseSnackbar}\n                severity=\"error\"\n                sx={{ width: \"100%\" }}\n              >\n                {snackbarMessage}\n              </Alert>\n            )}\n          </Snackbar>\n        </MDBContainer>\n      )}\n    </>\n  );\n}\n\nexport default ZollDocuments;\n"]},"metadata":{},"sourceType":"module"}