{"ast":null,"code":"import _objectSpread from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/regenerator/index.js\";import axiosInstance from\"../axiosApi\";import useAuth from\"./useAuth\";import useAxiosPrivate from\"./useAxiosPrivate\";var useDataUpdate=function useDataUpdate(){var _useAuth=useAuth(),setAuth=_useAuth.setAuth;var axiosInstance=useAxiosPrivate();//Globale Nutzerdaten abfragen, die dann anwendungsweit zur Verfügung gestellt werden\nvar dataUpdate=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axiosInstance.get('user');case 2:response=_context.sent;if(!(response.data[0].role==\"company_employee\")){_context.next=6;break;}setAuth(function(prev){var _response$data$0$empl,_response$data$0$empl2,_response$data$0$empl3;return _objectSpread(_objectSpread({},prev),{},{username:response.data[0].username,company:(_response$data$0$empl=response.data[0].employee)===null||_response$data$0$empl===void 0?void 0:_response$data$0$empl.company.name,pubkey:(_response$data$0$empl2=response.data[0].employee)===null||_response$data$0$empl2===void 0?void 0:_response$data$0$empl2.company.publickey,eori_nr:(_response$data$0$empl3=response.data[0].employee)===null||_response$data$0$empl3===void 0?void 0:_response$data$0$empl3.company.eori_nr,role:response.data[0].role,userData:response.data[0]});});return _context.abrupt(\"return\");case 6:setAuth(function(prev){var _response$data$0$empl4,_response$data$0$empl5,_response$data$0$empl6;//console.log(`New Username received : ${response.data[0].username}`);\nreturn _objectSpread(_objectSpread({},prev),{},{username:response.data[0].username,company:(_response$data$0$empl4=response.data[0].employee)===null||_response$data$0$empl4===void 0?void 0:_response$data$0$empl4.custom_office.name,pubkey:(_response$data$0$empl5=response.data[0].employee)===null||_response$data$0$empl5===void 0?void 0:_response$data$0$empl5.custom_office.publickey,eori_nr:(_response$data$0$empl6=response.data[0].employee)===null||_response$data$0$empl6===void 0?void 0:_response$data$0$empl6.custom_office.id,role:response.data[0].role});});return _context.abrupt(\"return\");case 8:case\"end\":return _context.stop();}}},_callee);}));return function dataUpdate(){return _ref.apply(this,arguments);};}();return dataUpdate;};export default useDataUpdate;","map":{"version":3,"sources":["/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/src/hooks/useDataUpdate.js"],"names":["axiosInstance","useAuth","useAxiosPrivate","useDataUpdate","setAuth","dataUpdate","get","response","data","role","prev","username","company","employee","name","pubkey","publickey","eori_nr","userData","custom_office","id"],"mappings":"icAAA,MAAOA,CAAAA,aAAP,KAA0B,aAA1B,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAOC,CAAAA,eAAP,KAA4B,mBAA5B,CAGA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CACxB,aAAoBF,OAAO,EAA3B,CAAQG,OAAR,UAAQA,OAAR,CACA,GAAMJ,CAAAA,aAAa,CAAGE,eAAe,EAArC,CAEA;AAEA,GAAMG,CAAAA,UAAU,0FAAG,sKAEQL,CAAAA,aAAa,CAACM,GAAd,CAAkB,MAAlB,CAFR,QAETC,QAFS,oBAKXA,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBC,IAAjB,EAAuB,kBALZ,0BAMXL,OAAO,CAAC,SAAAM,IAAI,CAAI,yEACZ,sCACOA,IADP,MAEIC,QAAQ,CAAEJ,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBG,QAF/B,CAGIC,OAAO,wBAAEL,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBK,QAAnB,gDAAE,sBAA2BD,OAA3B,CAAmCE,IAHhD,CAIIC,MAAM,yBAAER,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBK,QAAnB,iDAAE,uBAA2BD,OAA3B,CAAmCI,SAJ/C,CAKIC,OAAO,yBAAEV,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBK,QAAnB,iDAAE,uBAA2BD,OAA3B,CAAmCK,OALhD,CAMIR,IAAI,CAAEF,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBC,IAN3B,CAOIS,QAAQ,CAAEX,QAAQ,CAACC,IAAT,CAAc,CAAd,CAPd,GASH,CAVM,CAAP,CANW,wCAmBfJ,OAAO,CAAC,SAAAM,IAAI,CAAI,0EACZ;AACA,sCACOA,IADP,MAEIC,QAAQ,CAAEJ,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBG,QAF/B,CAGIC,OAAO,yBAAEL,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBK,QAAnB,iDAAE,uBAA2BM,aAA3B,CAAyCL,IAHtD,CAIIC,MAAM,yBAAER,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBK,QAAnB,iDAAE,uBAA2BM,aAA3B,CAAyCH,SAJrD,CAKIC,OAAO,yBAAEV,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBK,QAAnB,iDAAE,uBAA2BM,aAA3B,CAAyCC,EALtD,CAMIX,IAAI,CAAEF,QAAQ,CAACC,IAAT,CAAc,CAAd,EAAiBC,IAN3B,GAQH,CAVM,CAAP,CAnBe,uFAAH,kBAAVJ,CAAAA,UAAU,0CAAhB,CAmCF,MAAOA,CAAAA,UAAP,CAED,CA3CD,CA6CA,cAAeF,CAAAA,aAAf","sourcesContent":["import axiosInstance from \"../axiosApi\"\nimport useAuth from \"./useAuth\"\nimport useAxiosPrivate from \"./useAxiosPrivate\";\n\n\nconst useDataUpdate = () => {\n    const { setAuth } = useAuth();\n    const axiosInstance = useAxiosPrivate();\n\n    //Globale Nutzerdaten abfragen, die dann anwendungsweit zur Verfügung gestellt werden\n\n    const dataUpdate = async() => {\n        //console.log(`Neue Nutzerdaten werden angefordert`);\n        const response = await axiosInstance.get('user')\n        //console.log(response.data[0])\n        //Unterscheiden wird Rollenbezogen für Zoll und Unternehmensmitarbeiter \n        if (response.data[0].role==\"company_employee\") {\n            setAuth(prev => {\n                return {\n                    ...prev,\n                    username: response.data[0].username,\n                    company: response.data[0].employee?.company.name,\n                    pubkey: response.data[0].employee?.company.publickey,\n                    eori_nr: response.data[0].employee?.company.eori_nr,\n                    role: response.data[0].role,\n                    userData: response.data[0]\n                }\n            });\n            return; \n        }\n        setAuth(prev => {\n            //console.log(`New Username received : ${response.data[0].username}`);\n            return {\n                ...prev,\n                username: response.data[0].username,\n                company: response.data[0].employee?.custom_office.name,\n                pubkey: response.data[0].employee?.custom_office.publickey,\n                eori_nr: response.data[0].employee?.custom_office.id,\n                role: response.data[0].role\n            }\n        });\n        return; \n\n\n\n    }\n  return dataUpdate\n\n}\n\nexport default useDataUpdate"]},"metadata":{},"sourceType":"module"}