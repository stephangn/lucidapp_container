{"ast":null,"code":"import _defineProperty from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect}from\"react\";import useAxiosPrivate from\"../hooks/useAxiosPrivate\";import{Link,useParams,useNavigate}from\"react-router-dom\";import\"./css/LoadingSpinner.css\";// Unterformulare\nimport AllgemeineAngaben from\"../components/Declaration/AllgemeineAngaben\";import Adressdaten from\"../components/Declaration/Adressdaten\";import Lieferdaten from\"../components/Declaration/Lieferdaten\";import Rechnungsdaten from\"../components/Declaration/Rechnungsdaten\";import AnmeldungDokumente from\"../components/Declaration/AnmeldungDokumente\";import{MDBContainer,MDBSpinner,MDBBreadcrumb,MDBBreadcrumbItem}from\"mdb-react-ui-kit\";//Smart Contract\nimport{createZollanmeldung}from\"../Web3Client\";// Stepper\nimport Box from\"@mui/material/Box\";import Stepper from\"@mui/material/Stepper\";import Step from\"@mui/material/Step\";import StepLabel from\"@mui/material/StepLabel\";import Button from\"@mui/material/Button\";import Typography from\"@mui/material/Typography\";// Loading Backdrop\nimport Backdrop from\"@mui/material/Backdrop\";//Nutzerdaten Abruf\nimport useAuth from\"../hooks/useAuth\";import{CircularProgress}from\"@mui/material\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Declaration(props){var _jsx2,_jsx3,_jsx4,_jsx5,_jsx6;var _useState=useState(),_useState2=_slicedToArray(_useState,2),usedInvoice=_useState2[0],setUsedInvoice=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),pubkeyCO=_useState6[0],setPubkeyCO=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),transactionInvoices=_useState8[0],setTransactionInvoices=_useState8[1];//state für dokumente\nvar usedDocuments=[];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),documents=_useState10[0],setDocuments=_useState10[1];//auswahl für Zollämter\nvar _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),customOffices=_useState12[0],setCustomOffices=_useState12[1];//funktion für Nutzerdaten\nvar _useAuth=useAuth(),auth=_useAuth.auth;//Abfrage der TransaktionsID\nvar _useParams=useParams(),transactionId=_useParams.transactionId;// Stepper-Logik\nvar steps=[\"Allgemeine Angaben\",\"Adressdaten\",\"Lieferdaten\",\"Rechnungsdaten\",\"Dokumente\"];var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),activeStep=_React$useState2[0],setActiveStep=_React$useState2[1];var _React$useState3=React.useState(new Set()),_React$useState4=_slicedToArray(_React$useState3,2),skipped=_React$useState4[0],setSkipped=_React$useState4[1];// (Kein Step ist optional)\nvar isStepOptional=function isStepOptional(step){return;};//Abfrage der voreingestellten Daten\nvar axiosInstance=useAxiosPrivate();var isStepSkipped=function isStepSkipped(step){return skipped.has(step);};var handleNext=function handleNext(e){var newSkipped=skipped;if(isStepSkipped(activeStep)){newSkipped=new Set(newSkipped.values());newSkipped.delete(activeStep);}// Check Validierung\nif(activeStep===0&&allgemeineAngabenValidity==false){return;}if(activeStep===2&&lieferdatenValidity==false){return;}if(activeStep===3&&rechnungsdatenValidity==false){return;}e.preventDefault();setActiveStep(function(prevActiveStep){return prevActiveStep+1;});setSkipped(newSkipped);};var handleBack=function handleBack(){setActiveStep(function(prevActiveStep){return prevActiveStep-1;});};var handleSkip=function handleSkip(){if(!isStepOptional(activeStep)){// You probably want to guard against something like this,\n// it should never occur unless someone's actively trying to break something.\nthrow new Error(\"You can't skip a step that isn't optional.\");}setActiveStep(function(prevActiveStep){return prevActiveStep+1;});setSkipped(function(prevSkipped){var newSkipped=new Set(prevSkipped.values());newSkipped.add(activeStep);return newSkipped;});};var handleReset=function handleReset(){setActiveStep(0);};//Übertragen der Daten\nfunction handleSubmit(){return _handleSubmit.apply(this,arguments);}// -- DATENFELDER --\n// State des Inhalts der Felder\nfunction _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var zollwert;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:// Backdrop Ladeanimation öffnen\nhandleToggleBackdrop();_context3.next=3;return fieldValue.gesamtbetrag;case 3:_context3.t0=_context3.sent;_context3.t1=fieldValue.lieferkosten;zollwert=_context3.t0+_context3.t1;_context3.next=8;return blockchainZollanmeldungTransaction(pubkeyCO,fieldValue.blockchainRID,zollwert.toString(),fieldValue.lieferbedingung);case 8:return _context3.abrupt(\"return\");case 9:case\"end\":return _context3.stop();}}},_callee3);}));return _handleSubmit.apply(this,arguments);}var _React$useState5=React.useState({// Allgemeine Angaben\nauftragsnummer:\"\",bearbeitendeDienststelle:\"\",anmeldungArt:\"\",geschaeftArt:\"\",zahlungArt:\"\",// Adressdaten Versender\neoriVersender:\"\",nameVersender:\"\",vornameVersender:\"\",firmaVersender:\"\",strasseVersender:\"\",plzVersender:\"\",ortVersender:\"\",staatVersender:\"\",telefonVersender:\"\",emailVersender:\"\",// Adressdaten Anmelder\neoriAnmelder:\"\",nameAnmelder:\"\",vornameAnmelder:\"\",firmaAnmelder:\"\",strasseAnmelder:\"\",plzAnmelder:\"\",ortAnmelder:\"\",staatAnmelder:\"\",telefonAnmelder:\"\",emailAnmelder:\"\",// Lieferdaten\nausfuhrland:\"\",bestimmungsland:\"\",bestimmungsbundesland:\"\",befoerderungsmittel:\"\",lieferbedingung:\"\",lieferort:\"\",warenort:\"\",lieferkosten:\"\",//Rechnungsdaten\ndatumRechnung:\"\",gesamtbetrag:\"\",waehrung:\"\"}),_React$useState6=_slicedToArray(_React$useState5,2),fieldValue=_React$useState6[0],setFieldValue=_React$useState6[1];var _React$useState7=React.useState([{}]),_React$useState8=_slicedToArray(_React$useState7,2),rechnungsposten=_React$useState8[0],setRechnungsposten=_React$useState8[1];// Legacy State über fehlende Eingaben\n// -> Keine manuelle Validierung mehr, sondern HTML5 Required-Validierung\nvar _React$useState9=React.useState({// Allgemeine Angaben\nauftragsnummer:false,bearbeitendeDienststelle:false,anmeldungArt:false,geschaeftArt:false,zahlungArt:false,// Adressdaten Versender\neoriVersender:false,nameVersender:false,vornameVersender:false,firmaVersender:false,strasseVersender:false,plzVersender:false,ortVersender:false,staatVersender:false,telefonVersender:false,emailVersender:false,// Adressdaten Anmelder\neoriAnmelder:false,nameAnmelder:false,vornameAnmelder:false,firmaAnmelder:false,strasseAnmelder:false,plzAnmelder:false,ortAnmelder:false,staatAnmelder:false,telefonAnmelder:false,emailAnmelder:false,// Lieferdaten\nausfuhrland:false,bestimmungsland:false,bestimmungsbundesland:false,befoerderungsmittel:false,lieferbedingung:false,lieferort:false,warenort:false,lieferkosten:false,//Rechnungsdaten\ndatumRechnung:false,gesamtbetrag:false,waehrung:false}),_React$useState10=_slicedToArray(_React$useState9,2),inputMissingError=_React$useState10[0],setInputMissingError=_React$useState10[1];// Legacy State über falsche Inputs (müssen Zahlen sein)\n// -> Keine manuelle Validierung mehr, sondern HTML5 Required-Validierung\nvar _React$useState11=React.useState({auftragsnummer:false,eoriVersender:false,plzVersender:false,eoriAnmelder:false,plsAnmelder:false,lieferkosten:false}),_React$useState12=_slicedToArray(_React$useState11,2),inputWrongError=_React$useState12[0],setInputWrongError=_React$useState12[1];// Neue Validierung-States\nvar _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),allgemeineAngabenValidity=_useState14[0],setAllgemeineAngabenValidity=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),lieferdatenValidity=_useState16[0],setLieferdatenValidity=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),rechnungsdatenValidity=_useState18[0],setRechnungsdatenValidity=_useState18[1];// FieldChange für Select und String-Felder\nfunction handleFieldChange(event){var name=event.target.name;var value=event.target.value;setFieldValue(_objectSpread(_objectSpread({},fieldValue),{},_defineProperty({},name,value)));setInputMissingError(_objectSpread(_objectSpread({},inputMissingError),{},_defineProperty({},name,false)));}// FieldChange für Zahlen-Inputfelder\nfunction handleNumberFieldChange(event){var name=event.target.name;var value=event.target.value;// Validierung: nur Zahlen\nif(isNaN(value)){setInputWrongError(_objectSpread(_objectSpread({},inputWrongError),{},_defineProperty({},name,true)));}else{setInputWrongError(_objectSpread(_objectSpread({},inputWrongError),{},_defineProperty({},name,false)));}setFieldValue(_objectSpread(_objectSpread({},fieldValue),{},_defineProperty({},name,value)));setInputMissingError(_objectSpread(_objectSpread({},inputMissingError),{},_defineProperty({},name,false)));}// Abfragen der Bestandsdaten\nuseEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axiosInstance.get(\"transactions/\"+transactionId).then(function(res){setFieldValue(function(prev){return _objectSpread(_objectSpread({},prev),{},{auftragsnummer:res.data.id,eoriVersender:res.data.partnership.partner.eori_nr,//nameVersender: .partnership.partner.name,\nfirmaVersender:res.data.partnership.partner.name,strasseVersender:res.data.partnership.partner.street,plzVersender:res.data.partnership.partner.city_code,ortVersender:res.data.partnership.partner.city,staatVersender:res.data.partnership.partner.country_code,telefonVersender:res.data.partnership.partner.phone,emailVersender:res.data.partnership.partner.email,exporteur_pubkey:res.data.partnership.partner.publickey});});setIsLoading(false);});case 2:_context.next=4;return axiosInstance.get(\"user/\").then(function(response){setFieldValue(function(prev){var _response$data$0$empl;return _objectSpread(_objectSpread({},prev),{},{eoriAnmelder:(_response$data$0$empl=response.data[0].employee)===null||_response$data$0$empl===void 0?void 0:_response$data$0$empl.company.eori_nr,//nameVersender: .partnership.partner.name,\nfirmaAnmelder:response.data[0].employee.company.name,strasseAnmelder:response.data[0].employee.company.street,plzAnmelder:response.data[0].employee.company.city_code,ortAnmelder:response.data[0].employee.company.city,staatAnmelder:response.data[0].employee.company.country_code,telefonAnmelder:response.data[0].employee.company.phone,emailAnmelder:response.data[0].employee.company.email});});});case 4:_context.next=6;return axiosInstance.get(\"invoice/?transaction=\".concat(transactionId)).then(function(response){setTransactionInvoices(response.data);});case 6:_context.next=8;return axiosInstance.get(\"customoffices/\").then(function(res){setCustomOffices(res.data);//setCompanies(res.data);\n});case 8:_context.next=10;return axiosInstance.get(\"documents/?transaction=\"+transactionId).then(function(res){setDocuments(res.data);//setCompanies(res.data);\n});case 10:case\"end\":return _context.stop();}}},_callee);})),[transactionId]);//Abfrage der Rechnungsdaten\nuseEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(typeof usedInvoice!==\"undefined\")){_context2.next=3;break;}_context2.next=3;return axiosInstance.get(\"invoice/\".concat(usedInvoice,\"/\")).then(function(response){var _response$data8;setFieldValue(function(prev){var _response$data,_response$data2,_response$data3,_response$data4,_response$data5,_response$data6,_response$data7,_objectSpread8;return _objectSpread(_objectSpread({},prev),{},(_objectSpread8={waehrung:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.currency,datumRechnung:(_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.issue_date,gesamtbetrag:(_response$data3=response.data)===null||_response$data3===void 0?void 0:_response$data3.total_value,lieferkosten:(_response$data4=response.data)===null||_response$data4===void 0?void 0:_response$data4.transport_costs},_defineProperty(_objectSpread8,\"gesamtbetrag\",(_response$data5=response.data)===null||_response$data5===void 0?void 0:_response$data5.total_value),_defineProperty(_objectSpread8,\"blockchainRID\",(_response$data6=response.data)===null||_response$data6===void 0?void 0:_response$data6.blockchain_id),_defineProperty(_objectSpread8,\"rechnungID\",(_response$data7=response.data)===null||_response$data7===void 0?void 0:_response$data7.id),_objectSpread8));});setRechnungsposten((_response$data8=response.data)===null||_response$data8===void 0?void 0:_response$data8.invoiceItem);});case 3:case\"end\":return _context2.stop();}}},_callee2);})),[usedInvoice]);// Blockchain Transaktion\nfunction blockchainZollanmeldungTransaction(_x,_x2,_x3,_x4){return _blockchainZollanmeldungTransaction.apply(this,arguments);}// Navigation an DocumentsNew\n//+ State: Informationen für Snackbar Alert\nfunction _blockchainZollanmeldungTransaction(){_blockchainZollanmeldungTransaction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(_zoll,_rechnungID,_zollwert,_incoterms){var erfolgreich;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:erfolgreich=false;_context4.next=3;return createZollanmeldung(_zoll,_rechnungID,_zollwert,_incoterms).then(function(tx){console.log(tx);erfolgreich=true;axiosInstance.post(\"/declaration/\",{anmeldeArt:fieldValue.anmeldungArt,geschaeftArt:fieldValue.geschaeftArt,zahlungsart:fieldValue===null||fieldValue===void 0?void 0:fieldValue.zahlungArt,ausfuhrland:fieldValue.ausfuhrland,bestimmungsland:fieldValue.bestimmungsland,befoerderungsmittel:fieldValue.befoerderungsmittel,lieferbedingung:fieldValue.lieferbedingung,lieferort:fieldValue.lieferort,warenort:fieldValue===null||fieldValue===void 0?void 0:fieldValue.warenort,invoice:usedInvoice,transaction:transactionId,customs_office:fieldValue.bearbeitendeDienststelle,blockchain_zid:tx-1,document:usedDocuments}).then(function(res){// Backdrop Ladeanimation schließen\nhandleCloseBackdrop();handleNavigate(true,\"Zollanmeldung angelegt und übermittelt.\");}).catch(function(error){if(error.response){// The request was made and the server responded with a status code\n// that falls out of the range of 2xx\nconsole.log(error.response.data);console.log(error.response.status);console.log(error.response.headers);// Backdrop Ladeanimation schließen\n// Backdrop Ladeanimation schließen\nhandleCloseBackdrop();handleNavigate(false,\"Fehler bei Erstellung der Zollanmeldung.\");}else if(error.request){// The request was made but no response was received\n// `error.request` is an instance of XMLHttpRequest in the browser and an instance of\n// http.ClientRequest in node.js\nconsole.log(error.request);handleNavigate(false,\"Fehler bei Erstellung der Zollanmeldung.\");}else{// Something happened in setting up the request that triggered an Error\nconsole.log(\"Error\",error.message);handleNavigate(false,\"Fehler bei Erstellung der Zollanmeldung.\");}});}).catch(function(err){console.log(err);});case 3:return _context4.abrupt(\"return\",erfolgreich);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return _blockchainZollanmeldungTransaction.apply(this,arguments);}var navigate=useNavigate();function handleNavigate(snackSuccess,snackMessage){var urladdress=\"/transactions/\"+fieldValue.auftragsnummer;navigate(urladdress,{replace:true,state:{success:snackSuccess,message:snackMessage}});}// -- Loading Backdrop --\nvar _React$useState13=React.useState(false),_React$useState14=_slicedToArray(_React$useState13,2),openBackdrop=_React$useState14[0],setOpenBackdrop=_React$useState14[1];var handleCloseBackdrop=function handleCloseBackdrop(){setOpenBackdrop(false);};var handleToggleBackdrop=function handleToggleBackdrop(){setOpenBackdrop(!openBackdrop);};return/*#__PURE__*/_jsx(_Fragment,{children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"loadingSpinner\",children:/*#__PURE__*/_jsx(MDBSpinner,{children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"L\\xE4dt..\"})})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Zollanmeldung erstellen\"}),/*#__PURE__*/_jsxs(MDBBreadcrumb,{children:[/*#__PURE__*/_jsx(MDBBreadcrumbItem,{children:/*#__PURE__*/_jsx(Link,{to:\"/transactions\",children:\"Auftr\\xE4ge\"})}),/*#__PURE__*/_jsx(MDBBreadcrumbItem,{children:/*#__PURE__*/_jsxs(Link,{to:\"/transactions/\"+transactionId,children:[\"Auftrags-ID \",transactionId]})}),/*#__PURE__*/_jsx(MDBBreadcrumbItem,{active:true,children:\"Formular Zollanmeldung\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Box,{sx:{width:\"100%\"},children:[/*#__PURE__*/_jsx(Stepper,{className:\"mb-3\",activeStep:activeStep,children:steps.map(function(label,index){var stepProps={};var labelProps={};if(isStepOptional(index)){labelProps.optional=/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:\"Optional\"});}if(isStepSkipped(index)){stepProps.completed=false;}return/*#__PURE__*/_jsx(Step,_objectSpread(_objectSpread({},stepProps),{},{children:/*#__PURE__*/_jsx(StepLabel,_objectSpread(_objectSpread({},labelProps),{},{children:label}))}),label);})}),activeStep===steps.length?/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(Typography,{sx:{mt:2,mb:1},children:\"All steps completed - you're finished\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",flexDirection:\"row\",pt:2},children:[/*#__PURE__*/_jsx(Box,{sx:{flex:\"1 1 auto\"}}),/*#__PURE__*/_jsx(Button,{onClick:handleReset,children:\"Zur\\xFCcksetzen\"})]})]}):/*#__PURE__*/_jsx(React.Fragment,{children:activeStep===0?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(MDBContainer,{children:/*#__PURE__*/_jsx(AllgemeineAngaben,(_jsx2={fieldValue:fieldValue,customOffices:customOffices,setPubkeyCO:setPubkeyCO,setFieldValue:setFieldValue,inputMissingError:inputMissingError,setInputMissingError:setInputMissingError,inputWrongError:inputWrongError,setInputWrongError:setInputWrongError,handleFieldChange:handleFieldChange,handleNumberFieldChange:handleNumberFieldChange// Validierung State\n,allgemeineAngabenValidity:allgemeineAngabenValidity,setAllgemeineAngabenValidity:setAllgemeineAngabenValidity// Stepper Funktionen\n,handleBack:handleBack,isStepOptional:isStepOptional,activeStep:activeStep,handleSkip:handleSkip},_defineProperty(_jsx2,\"activeStep\",activeStep),_defineProperty(_jsx2,\"steps\",steps),_defineProperty(_jsx2,\"handleSubmit\",handleSubmit),_defineProperty(_jsx2,\"handleNext\",handleNext),_jsx2))})}):activeStep===1?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(MDBContainer,{children:/*#__PURE__*/_jsx(Adressdaten,(_jsx3={fieldValue:fieldValue,setFieldValue:setFieldValue,inputMissingError:inputMissingError,setInputMissingError:setInputMissingError,inputWrongError:inputWrongError,setInputWrongError:setInputWrongError,handleFieldChange:handleFieldChange,handleNumberFieldChange:handleNumberFieldChange// Stepper Funktionen\n,handleBack:handleBack,isStepOptional:isStepOptional,activeStep:activeStep,handleSkip:handleSkip},_defineProperty(_jsx3,\"activeStep\",activeStep),_defineProperty(_jsx3,\"steps\",steps),_defineProperty(_jsx3,\"handleSubmit\",handleSubmit),_defineProperty(_jsx3,\"handleNext\",handleNext),_jsx3))})}):activeStep===2?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(MDBContainer,{children:/*#__PURE__*/_jsx(Lieferdaten,(_jsx4={fieldValue:fieldValue,setFieldValue:setFieldValue,inputMissingError:inputMissingError,setInputMissingError:setInputMissingError,inputWrongError:inputWrongError,setInputWrongError:setInputWrongError,handleFieldChange:handleFieldChange,handleNumberFieldChange:handleNumberFieldChange// Validierung State\n,lieferdatenValidity:lieferdatenValidity,setLieferdatenValidity:setLieferdatenValidity// Stepper Funktionen\n,handleBack:handleBack,isStepOptional:isStepOptional,activeStep:activeStep,handleSkip:handleSkip},_defineProperty(_jsx4,\"activeStep\",activeStep),_defineProperty(_jsx4,\"steps\",steps),_defineProperty(_jsx4,\"handleSubmit\",handleSubmit),_defineProperty(_jsx4,\"handleNext\",handleNext),_jsx4))})}):activeStep===3?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(MDBContainer,{children:/*#__PURE__*/_jsx(Rechnungsdaten,(_jsx5={fieldValue:fieldValue,setFieldValue:setFieldValue,inputMissingError:inputMissingError,setInputMissingError:setInputMissingError,inputWrongError:inputWrongError,setInputWrongError:setInputWrongError,handleFieldChange:handleFieldChange,handleNumberFieldChange:handleNumberFieldChange,rechnungsposten:rechnungsposten,setRechnungsposten:setRechnungsposten,transactionInvoices:transactionInvoices,usedInvoice:usedInvoice,setUsedInvoice:setUsedInvoice// Validierung State\n,rechnungsdatenValidity:rechnungsdatenValidity,setRechnungsdatenValidity:setRechnungsdatenValidity// Stepper Funktionen\n,handleBack:handleBack,isStepOptional:isStepOptional,activeStep:activeStep,handleSkip:handleSkip},_defineProperty(_jsx5,\"activeStep\",activeStep),_defineProperty(_jsx5,\"steps\",steps),_defineProperty(_jsx5,\"handleSubmit\",handleSubmit),_defineProperty(_jsx5,\"handleNext\",handleNext),_jsx5))})}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(MDBContainer,{children:/*#__PURE__*/_jsx(AnmeldungDokumente,(_jsx6={usedDocuments:usedDocuments,documents:documents// Stepper Funktionen\n,handleBack:handleBack,isStepOptional:isStepOptional,activeStep:activeStep,handleSkip:handleSkip},_defineProperty(_jsx6,\"activeStep\",activeStep),_defineProperty(_jsx6,\"steps\",steps),_defineProperty(_jsx6,\"handleSubmit\",handleSubmit),_defineProperty(_jsx6,\"handleNext\",handleNext),_jsx6))})})})]})}),/*#__PURE__*/_jsx(Backdrop,{sx:{color:\"#fff\",zIndex:function zIndex(theme){return theme.zIndex.drawer+1;}},open:openBackdrop,onClick:handleCloseBackdrop,children:/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\"})})]})});}export default Declaration;","map":{"version":3,"sources":["/Users/stephan/Dropbox/Entwicklung/webdev/projektstudium/client/src/pages/Declaration.jsx"],"names":["React","useState","useEffect","useAxiosPrivate","Link","useParams","useNavigate","AllgemeineAngaben","Adressdaten","Lieferdaten","Rechnungsdaten","AnmeldungDokumente","MDBContainer","MDBSpinner","MDBBreadcrumb","MDBBreadcrumbItem","createZollanmeldung","Box","Stepper","Step","StepLabel","Button","Typography","Backdrop","useAuth","CircularProgress","Declaration","props","usedInvoice","setUsedInvoice","isLoading","setIsLoading","pubkeyCO","setPubkeyCO","transactionInvoices","setTransactionInvoices","usedDocuments","documents","setDocuments","customOffices","setCustomOffices","auth","transactionId","steps","activeStep","setActiveStep","Set","skipped","setSkipped","isStepOptional","step","axiosInstance","isStepSkipped","has","handleNext","e","newSkipped","values","delete","allgemeineAngabenValidity","lieferdatenValidity","rechnungsdatenValidity","preventDefault","prevActiveStep","handleBack","handleSkip","Error","prevSkipped","add","handleReset","handleSubmit","handleToggleBackdrop","fieldValue","gesamtbetrag","lieferkosten","zollwert","blockchainZollanmeldungTransaction","blockchainRID","toString","lieferbedingung","auftragsnummer","bearbeitendeDienststelle","anmeldungArt","geschaeftArt","zahlungArt","eoriVersender","nameVersender","vornameVersender","firmaVersender","strasseVersender","plzVersender","ortVersender","staatVersender","telefonVersender","emailVersender","eoriAnmelder","nameAnmelder","vornameAnmelder","firmaAnmelder","strasseAnmelder","plzAnmelder","ortAnmelder","staatAnmelder","telefonAnmelder","emailAnmelder","ausfuhrland","bestimmungsland","bestimmungsbundesland","befoerderungsmittel","lieferort","warenort","datumRechnung","waehrung","setFieldValue","rechnungsposten","setRechnungsposten","inputMissingError","setInputMissingError","plsAnmelder","inputWrongError","setInputWrongError","setAllgemeineAngabenValidity","setLieferdatenValidity","setRechnungsdatenValidity","handleFieldChange","event","name","target","value","handleNumberFieldChange","isNaN","get","then","res","prev","data","id","partnership","partner","eori_nr","street","city_code","city","country_code","phone","email","exporteur_pubkey","publickey","response","employee","company","currency","issue_date","total_value","transport_costs","blockchain_id","invoiceItem","_zoll","_rechnungID","_zollwert","_incoterms","erfolgreich","tx","console","log","post","anmeldeArt","zahlungsart","invoice","transaction","customs_office","blockchain_zid","document","handleCloseBackdrop","handleNavigate","catch","error","status","headers","request","message","err","navigate","snackSuccess","snackMessage","urladdress","replace","state","success","openBackdrop","setOpenBackdrop","width","map","label","index","stepProps","labelProps","optional","completed","length","mt","mb","display","flexDirection","pt","flex","color","zIndex","theme","drawer"],"mappings":"6uBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,eAAP,KAA4B,0BAA5B,CACA,OAASC,IAAT,CAAeC,SAAf,CAA0BC,WAA1B,KAA6C,kBAA7C,CACA,MAAO,0BAAP,CAEA;AACA,MAAOC,CAAAA,iBAAP,KAA8B,6CAA9B,CACA,MAAOC,CAAAA,WAAP,KAAwB,uCAAxB,CACA,MAAOC,CAAAA,WAAP,KAAwB,uCAAxB,CACA,MAAOC,CAAAA,cAAP,KAA2B,0CAA3B,CACA,MAAOC,CAAAA,kBAAP,KAA+B,8CAA/B,CAEA,OACEC,YADF,CAEEC,UAFF,CAGEC,aAHF,CAIEC,iBAJF,KAKO,kBALP,CAOA;AACA,OAASC,mBAAT,KAAoC,eAApC,CAEA;AACA,MAAOC,CAAAA,GAAP,KAAgB,mBAAhB,CACA,MAAOC,CAAAA,OAAP,KAAoB,uBAApB,CACA,MAAOC,CAAAA,IAAP,KAAiB,oBAAjB,CACA,MAAOC,CAAAA,SAAP,KAAsB,yBAAtB,CACA,MAAOC,CAAAA,MAAP,KAAmB,sBAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,0BAAvB,CAEA;AACA,MAAOC,CAAAA,QAAP,KAAqB,wBAArB,CAEA;AACA,MAAOC,CAAAA,OAAP,KAAoB,kBAApB,CACA,OAASC,gBAAT,KAAiC,eAAjC,C,6IAEA,QAASC,CAAAA,WAAT,CAAqBC,KAArB,CAA4B,mCAC1B,cAAsC1B,QAAQ,EAA9C,wCAAO2B,WAAP,eAAoBC,cAApB,eACA,eAAkC5B,QAAQ,CAAC,IAAD,CAA1C,yCAAO6B,SAAP,eAAkBC,YAAlB,eACA,eAAgC9B,QAAQ,EAAxC,yCAAO+B,QAAP,eAAiBC,WAAjB,eACA,eAAsDhC,QAAQ,EAA9D,yCAAOiC,mBAAP,eAA4BC,sBAA5B,eAEA;AAEA,GAAMC,CAAAA,aAAa,CAAG,EAAtB,CACA,eAAkCnC,QAAQ,EAA1C,0CAAOoC,SAAP,gBAAkBC,YAAlB,gBAEA;AAEA,gBAA0CrC,QAAQ,CAAC,EAAD,CAAlD,2CAAOsC,aAAP,gBAAsBC,gBAAtB,gBAEA;AACA,aAAiBhB,OAAO,EAAxB,CAAQiB,IAAR,UAAQA,IAAR,CAEA;AAEA,eAA0BpC,SAAS,EAAnC,CAAQqC,aAAR,YAAQA,aAAR,CAEA;AACA,GAAMC,CAAAA,KAAK,CAAG,CACZ,oBADY,CAEZ,aAFY,CAGZ,aAHY,CAIZ,gBAJY,CAKZ,WALY,CAAd,CAQA,oBAAoC3C,KAAK,CAACC,QAAN,CAAe,CAAf,CAApC,oDAAO2C,UAAP,qBAAmBC,aAAnB,qBACA,qBAA8B7C,KAAK,CAACC,QAAN,CAAe,GAAI6C,CAAAA,GAAJ,EAAf,CAA9B,qDAAOC,OAAP,qBAAgBC,UAAhB,qBAEA;AACA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,IAAD,CAAU,CAC/B,OACD,CAFD,CAIA;AACA,GAAMC,CAAAA,aAAa,CAAGhD,eAAe,EAArC,CAEA,GAAMiD,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACF,IAAD,CAAU,CAC9B,MAAOH,CAAAA,OAAO,CAACM,GAAR,CAAYH,IAAZ,CAAP,CACD,CAFD,CAIA,GAAMI,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,CAAD,CAAO,CACxB,GAAIC,CAAAA,UAAU,CAAGT,OAAjB,CACA,GAAIK,aAAa,CAACR,UAAD,CAAjB,CAA+B,CAC7BY,UAAU,CAAG,GAAIV,CAAAA,GAAJ,CAAQU,UAAU,CAACC,MAAX,EAAR,CAAb,CACAD,UAAU,CAACE,MAAX,CAAkBd,UAAlB,EACD,CACD;AACA,GAAIA,UAAU,GAAK,CAAf,EAAoBe,yBAAyB,EAAI,KAArD,CAA4D,CAC1D,OACD,CACD,GAAIf,UAAU,GAAK,CAAf,EAAoBgB,mBAAmB,EAAI,KAA/C,CAAsD,CACpD,OACD,CACD,GAAIhB,UAAU,GAAK,CAAf,EAAoBiB,sBAAsB,EAAI,KAAlD,CAAyD,CACvD,OACD,CACDN,CAAC,CAACO,cAAF,GACAjB,aAAa,CAAC,SAACkB,cAAD,QAAoBA,CAAAA,cAAc,CAAG,CAArC,EAAD,CAAb,CACAf,UAAU,CAACQ,UAAD,CAAV,CACD,CAnBD,CAqBA,GAAMQ,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvBnB,aAAa,CAAC,SAACkB,cAAD,QAAoBA,CAAAA,cAAc,CAAG,CAArC,EAAD,CAAb,CACD,CAFD,CAIA,GAAME,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvB,GAAI,CAAChB,cAAc,CAACL,UAAD,CAAnB,CAAiC,CAC/B;AACA;AACA,KAAM,IAAIsB,CAAAA,KAAJ,CAAU,4CAAV,CAAN,CACD,CAEDrB,aAAa,CAAC,SAACkB,cAAD,QAAoBA,CAAAA,cAAc,CAAG,CAArC,EAAD,CAAb,CACAf,UAAU,CAAC,SAACmB,WAAD,CAAiB,CAC1B,GAAMX,CAAAA,UAAU,CAAG,GAAIV,CAAAA,GAAJ,CAAQqB,WAAW,CAACV,MAAZ,EAAR,CAAnB,CACAD,UAAU,CAACY,GAAX,CAAexB,UAAf,EACA,MAAOY,CAAAA,UAAP,CACD,CAJS,CAAV,CAKD,CAbD,CAeA,GAAMa,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxBxB,aAAa,CAAC,CAAD,CAAb,CACD,CAFD,CAIA;AA1F0B,QA2FXyB,CAAAA,YA3FW,+CAyG1B;AACA;AA1G0B,+FA2F1B,qJACE;AACAC,oBAAoB,GAFtB,uBAG0BC,CAAAA,UAAU,CAACC,YAHrC,iDAGqDD,UAAU,CAACE,YAHhE,CAGQC,QAHR,kDAIQC,CAAAA,kCAAkC,CACtC5C,QADsC,CAEtCwC,UAAU,CAACK,aAF2B,CAGtCF,QAAQ,CAACG,QAAT,EAHsC,CAItCN,UAAU,CAACO,eAJ2B,CAJ1C,kGA3F0B,+CA2G1B,qBAAoC/E,KAAK,CAACC,QAAN,CAAe,CACjD;AACA+E,cAAc,CAAE,EAFiC,CAGjDC,wBAAwB,CAAE,EAHuB,CAIjDC,YAAY,CAAE,EAJmC,CAKjDC,YAAY,CAAE,EALmC,CAMjDC,UAAU,CAAE,EANqC,CAOjD;AACAC,aAAa,CAAE,EARkC,CASjDC,aAAa,CAAE,EATkC,CAUjDC,gBAAgB,CAAE,EAV+B,CAWjDC,cAAc,CAAE,EAXiC,CAYjDC,gBAAgB,CAAE,EAZ+B,CAajDC,YAAY,CAAE,EAbmC,CAcjDC,YAAY,CAAE,EAdmC,CAejDC,cAAc,CAAE,EAfiC,CAgBjDC,gBAAgB,CAAE,EAhB+B,CAiBjDC,cAAc,CAAE,EAjBiC,CAkBjD;AACAC,YAAY,CAAE,EAnBmC,CAoBjDC,YAAY,CAAE,EApBmC,CAqBjDC,eAAe,CAAE,EArBgC,CAsBjDC,aAAa,CAAE,EAtBkC,CAuBjDC,eAAe,CAAE,EAvBgC,CAwBjDC,WAAW,CAAE,EAxBoC,CAyBjDC,WAAW,CAAE,EAzBoC,CA0BjDC,aAAa,CAAE,EA1BkC,CA2BjDC,eAAe,CAAE,EA3BgC,CA4BjDC,aAAa,CAAE,EA5BkC,CA6BjD;AACAC,WAAW,CAAE,EA9BoC,CA+BjDC,eAAe,CAAE,EA/BgC,CAgCjDC,qBAAqB,CAAE,EAhC0B,CAiCjDC,mBAAmB,CAAE,EAjC4B,CAkCjD7B,eAAe,CAAE,EAlCgC,CAmCjD8B,SAAS,CAAE,EAnCsC,CAoCjDC,QAAQ,CAAE,EApCuC,CAqCjDpC,YAAY,CAAE,EArCmC,CAsCjD;AACAqC,aAAa,CAAE,EAvCkC,CAwCjDtC,YAAY,CAAE,EAxCmC,CAyCjDuC,QAAQ,CAAE,EAzCuC,CAAf,CAApC,qDAAOxC,UAAP,qBAAmByC,aAAnB,qBA4CA,qBAA8CjH,KAAK,CAACC,QAAN,CAAe,CAAC,EAAD,CAAf,CAA9C,qDAAOiH,eAAP,qBAAwBC,kBAAxB,qBAEA;AACA;AACA,qBAAkDnH,KAAK,CAACC,QAAN,CAAe,CAC/D;AACA+E,cAAc,CAAE,KAF+C,CAG/DC,wBAAwB,CAAE,KAHqC,CAI/DC,YAAY,CAAE,KAJiD,CAK/DC,YAAY,CAAE,KALiD,CAM/DC,UAAU,CAAE,KANmD,CAO/D;AACAC,aAAa,CAAE,KARgD,CAS/DC,aAAa,CAAE,KATgD,CAU/DC,gBAAgB,CAAE,KAV6C,CAW/DC,cAAc,CAAE,KAX+C,CAY/DC,gBAAgB,CAAE,KAZ6C,CAa/DC,YAAY,CAAE,KAbiD,CAc/DC,YAAY,CAAE,KAdiD,CAe/DC,cAAc,CAAE,KAf+C,CAgB/DC,gBAAgB,CAAE,KAhB6C,CAiB/DC,cAAc,CAAE,KAjB+C,CAkB/D;AACAC,YAAY,CAAE,KAnBiD,CAoB/DC,YAAY,CAAE,KApBiD,CAqB/DC,eAAe,CAAE,KArB8C,CAsB/DC,aAAa,CAAE,KAtBgD,CAuB/DC,eAAe,CAAE,KAvB8C,CAwB/DC,WAAW,CAAE,KAxBkD,CAyB/DC,WAAW,CAAE,KAzBkD,CA0B/DC,aAAa,CAAE,KA1BgD,CA2B/DC,eAAe,CAAE,KA3B8C,CA4B/DC,aAAa,CAAE,KA5BgD,CA6B/D;AACAC,WAAW,CAAE,KA9BkD,CA+B/DC,eAAe,CAAE,KA/B8C,CAgC/DC,qBAAqB,CAAE,KAhCwC,CAiC/DC,mBAAmB,CAAE,KAjC0C,CAkC/D7B,eAAe,CAAE,KAlC8C,CAmC/D8B,SAAS,CAAE,KAnCoD,CAoC/DC,QAAQ,CAAE,KApCqD,CAqC/DpC,YAAY,CAAE,KArCiD,CAsC/D;AACAqC,aAAa,CAAE,KAvCgD,CAwC/DtC,YAAY,CAAE,KAxCiD,CAyC/DuC,QAAQ,CAAE,KAzCqD,CAAf,CAAlD,sDAAOI,iBAAP,sBAA0BC,oBAA1B,sBA4CA;AACA;AACA,sBAA8CrH,KAAK,CAACC,QAAN,CAAe,CAC3D+E,cAAc,CAAE,KAD2C,CAE3DK,aAAa,CAAE,KAF4C,CAG3DK,YAAY,CAAE,KAH6C,CAI3DK,YAAY,CAAE,KAJ6C,CAK3DuB,WAAW,CAAE,KAL8C,CAM3D5C,YAAY,CAAE,KAN6C,CAAf,CAA9C,uDAAO6C,eAAP,sBAAwBC,kBAAxB,sBASA;AACA,gBACEvH,QAAQ,CAAC,KAAD,CADV,2CAAO0D,yBAAP,gBAAkC8D,4BAAlC,gBAEA,gBAAsDxH,QAAQ,CAAC,KAAD,CAA9D,2CAAO2D,mBAAP,gBAA4B8D,sBAA5B,gBACA,gBAA4DzH,QAAQ,CAAC,KAAD,CAApE,2CAAO4D,sBAAP,gBAA+B8D,yBAA/B,gBAEA;AACA,QAASC,CAAAA,iBAAT,CAA2BC,KAA3B,CAAkC,CAChC,GAAMC,CAAAA,IAAI,CAAGD,KAAK,CAACE,MAAN,CAAaD,IAA1B,CACA,GAAME,CAAAA,KAAK,CAAGH,KAAK,CAACE,MAAN,CAAaC,KAA3B,CAEAf,aAAa,gCAAMzC,UAAN,wBAAmBsD,IAAnB,CAA0BE,KAA1B,GAAb,CACAX,oBAAoB,gCAAMD,iBAAN,wBAA0BU,IAA1B,CAAiC,KAAjC,GAApB,CACD,CAED;AACA,QAASG,CAAAA,uBAAT,CAAiCJ,KAAjC,CAAwC,CACtC,GAAMC,CAAAA,IAAI,CAAGD,KAAK,CAACE,MAAN,CAAaD,IAA1B,CACA,GAAME,CAAAA,KAAK,CAAGH,KAAK,CAACE,MAAN,CAAaC,KAA3B,CAEA;AACA,GAAIE,KAAK,CAACF,KAAD,CAAT,CAAkB,CAChBR,kBAAkB,gCAAMD,eAAN,wBAAwBO,IAAxB,CAA+B,IAA/B,GAAlB,CACD,CAFD,IAEO,CACLN,kBAAkB,gCAAMD,eAAN,wBAAwBO,IAAxB,CAA+B,KAA/B,GAAlB,CACD,CAEDb,aAAa,gCAAMzC,UAAN,wBAAmBsD,IAAnB,CAA0BE,KAA1B,GAAb,CACAX,oBAAoB,gCAAMD,iBAAN,wBAA0BU,IAA1B,CAAiC,KAAjC,GAApB,CACD,CAED;AAEA5H,SAAS,sEAAC,yJACFiD,CAAAA,aAAa,CAACgF,GAAd,CAAkB,gBAAkBzF,aAApC,EAAmD0F,IAAnD,CAAwD,SAACC,GAAD,CAAS,CACrEpB,aAAa,CAAC,SAACqB,IAAD,CAAU,CACtB,sCACKA,IADL,MAEEtD,cAAc,CAAEqD,GAAG,CAACE,IAAJ,CAASC,EAF3B,CAGEnD,aAAa,CAAEgD,GAAG,CAACE,IAAJ,CAASE,WAAT,CAAqBC,OAArB,CAA6BC,OAH9C,CAIE;AACAnD,cAAc,CAAE6C,GAAG,CAACE,IAAJ,CAASE,WAAT,CAAqBC,OAArB,CAA6BZ,IAL/C,CAMErC,gBAAgB,CAAE4C,GAAG,CAACE,IAAJ,CAASE,WAAT,CAAqBC,OAArB,CAA6BE,MANjD,CAOElD,YAAY,CAAE2C,GAAG,CAACE,IAAJ,CAASE,WAAT,CAAqBC,OAArB,CAA6BG,SAP7C,CAQElD,YAAY,CAAE0C,GAAG,CAACE,IAAJ,CAASE,WAAT,CAAqBC,OAArB,CAA6BI,IAR7C,CASElD,cAAc,CAAEyC,GAAG,CAACE,IAAJ,CAASE,WAAT,CAAqBC,OAArB,CAA6BK,YAT/C,CAUElD,gBAAgB,CAAEwC,GAAG,CAACE,IAAJ,CAASE,WAAT,CAAqBC,OAArB,CAA6BM,KAVjD,CAWElD,cAAc,CAAEuC,GAAG,CAACE,IAAJ,CAASE,WAAT,CAAqBC,OAArB,CAA6BO,KAX/C,CAYEC,gBAAgB,CAAEb,GAAG,CAACE,IAAJ,CAASE,WAAT,CAAqBC,OAArB,CAA6BS,SAZjD,GAcD,CAfY,CAAb,CAgBApH,YAAY,CAAC,KAAD,CAAZ,CACD,CAlBK,CADE,8BAuBFoB,CAAAA,aAAa,CAACgF,GAAd,UAA2BC,IAA3B,CAAgC,SAACgB,QAAD,CAAc,CAClDnC,aAAa,CAAC,SAACqB,IAAD,CAAU,2BACtB,sCACKA,IADL,MAEEvC,YAAY,wBAAEqD,QAAQ,CAACb,IAAT,CAAc,CAAd,EAAiBc,QAAnB,gDAAE,sBAA2BC,OAA3B,CAAmCX,OAFnD,CAGE;AACAzC,aAAa,CAAEkD,QAAQ,CAACb,IAAT,CAAc,CAAd,EAAiBc,QAAjB,CAA0BC,OAA1B,CAAkCxB,IAJnD,CAKE3B,eAAe,CAAEiD,QAAQ,CAACb,IAAT,CAAc,CAAd,EAAiBc,QAAjB,CAA0BC,OAA1B,CAAkCV,MALrD,CAMExC,WAAW,CAAEgD,QAAQ,CAACb,IAAT,CAAc,CAAd,EAAiBc,QAAjB,CAA0BC,OAA1B,CAAkCT,SANjD,CAOExC,WAAW,CAAE+C,QAAQ,CAACb,IAAT,CAAc,CAAd,EAAiBc,QAAjB,CAA0BC,OAA1B,CAAkCR,IAPjD,CAQExC,aAAa,CAAE8C,QAAQ,CAACb,IAAT,CAAc,CAAd,EAAiBc,QAAjB,CAA0BC,OAA1B,CAAkCP,YARnD,CASExC,eAAe,CAAE6C,QAAQ,CAACb,IAAT,CAAc,CAAd,EAAiBc,QAAjB,CAA0BC,OAA1B,CAAkCN,KATrD,CAUExC,aAAa,CAAE4C,QAAQ,CAACb,IAAT,CAAc,CAAd,EAAiBc,QAAjB,CAA0BC,OAA1B,CAAkCL,KAVnD,GAYD,CAbY,CAAb,CAcD,CAfK,CAvBE,8BA0CF9F,CAAAA,aAAa,CAChBgF,GADG,gCACyBzF,aADzB,GAEH0F,IAFG,CAEE,SAACgB,QAAD,CAAc,CAClBjH,sBAAsB,CAACiH,QAAQ,CAACb,IAAV,CAAtB,CACD,CAJG,CA1CE,8BAiDFpF,CAAAA,aAAa,CAACgF,GAAd,CAAkB,gBAAlB,EAAoCC,IAApC,CAAyC,SAACC,GAAD,CAAS,CACtD7F,gBAAgB,CAAC6F,GAAG,CAACE,IAAL,CAAhB,CACA;AACD,CAHK,CAjDE,+BAsDFpF,CAAAA,aAAa,CAChBgF,GADG,CACC,0BAA4BzF,aAD7B,EAEH0F,IAFG,CAEE,SAACC,GAAD,CAAS,CACb/F,YAAY,CAAC+F,GAAG,CAACE,IAAL,CAAZ,CACA;AACD,CALG,CAtDE,wDAAD,GA4DN,CAAC7F,aAAD,CA5DM,CAAT,CA8DA;AACAxC,SAAS,sEAAC,6IACJ,MAAO0B,CAAAA,WAAP,GAAuB,WADnB,kDAEAuB,CAAAA,aAAa,CAACgF,GAAd,mBAA6BvG,WAA7B,OAA6CwG,IAA7C,CAAkD,SAACgB,QAAD,CAAc,qBACpEnC,aAAa,CAAC,SAACqB,IAAD,CAAU,mIACtB,sCACKA,IADL,sBAEEtB,QAAQ,iBAAEoC,QAAQ,CAACb,IAAX,yCAAE,eAAegB,QAF3B,CAGExC,aAAa,kBAAEqC,QAAQ,CAACb,IAAX,0CAAE,gBAAeiB,UAHhC,CAIE/E,YAAY,kBAAE2E,QAAQ,CAACb,IAAX,0CAAE,gBAAekB,WAJ/B,CAKE/E,YAAY,kBAAE0E,QAAQ,CAACb,IAAX,0CAAE,gBAAemB,eAL/B,iEAMgBN,QAAQ,CAACb,IANzB,0CAMgB,gBAAekB,WAN/B,kEAOiBL,QAAQ,CAACb,IAP1B,0CAOiB,gBAAeoB,aAPhC,+DAQcP,QAAQ,CAACb,IARvB,0CAQc,gBAAeC,EAR7B,mBAUD,CAXY,CAAb,CAYArB,kBAAkB,kBAACiC,QAAQ,CAACb,IAAV,0CAAC,gBAAeqB,WAAhB,CAAlB,CACD,CAdK,CAFA,yDAAD,GAkBN,CAAChI,WAAD,CAlBM,CAAT,CAoBA;AAtU0B,QAuUXgD,CAAAA,kCAvUW,mFAqY1B;AACA;AAtY0B,2IAuU1B,kBACEiF,KADF,CAEEC,WAFF,CAGEC,SAHF,CAIEC,UAJF,sIAMMC,WANN,CAMoB,KANpB,wBAOQjJ,CAAAA,mBAAmB,CAAC6I,KAAD,CAAQC,WAAR,CAAqBC,SAArB,CAAgCC,UAAhC,CAAnB,CACH5B,IADG,CACE,SAAC8B,EAAD,CAAQ,CACZC,OAAO,CAACC,GAAR,CAAYF,EAAZ,EACAD,WAAW,CAAG,IAAd,CACA9G,aAAa,CACVkH,IADH,CACQ,eADR,CACyB,CACrBC,UAAU,CAAE9F,UAAU,CAACU,YADF,CAErBC,YAAY,CAAEX,UAAU,CAACW,YAFJ,CAGrBoF,WAAW,CAAE/F,UAAF,SAAEA,UAAF,iBAAEA,UAAU,CAAEY,UAHJ,CAIrBqB,WAAW,CAAEjC,UAAU,CAACiC,WAJH,CAKrBC,eAAe,CAAElC,UAAU,CAACkC,eALP,CAMrBE,mBAAmB,CAAEpC,UAAU,CAACoC,mBANX,CAOrB7B,eAAe,CAAEP,UAAU,CAACO,eAPP,CAQrB8B,SAAS,CAAErC,UAAU,CAACqC,SARD,CASrBC,QAAQ,CAAEtC,UAAF,SAAEA,UAAF,iBAAEA,UAAU,CAAEsC,QATD,CAUrB0D,OAAO,CAAE5I,WAVY,CAWrB6I,WAAW,CAAE/H,aAXQ,CAYrBgI,cAAc,CAAElG,UAAU,CAACS,wBAZN,CAarB0F,cAAc,CAAET,EAAE,CAAG,CAbA,CAcrBU,QAAQ,CAAExI,aAdW,CADzB,EAiBGgG,IAjBH,CAiBQ,SAACC,GAAD,CAAS,CACb;AACAwC,mBAAmB,GACnBC,cAAc,CAAC,IAAD,CAAO,yCAAP,CAAd,CACD,CArBH,EAsBGC,KAtBH,CAsBS,SAAUC,KAAV,CAAiB,CACtB,GAAIA,KAAK,CAAC5B,QAAV,CAAoB,CAClB;AACA;AACAe,OAAO,CAACC,GAAR,CAAYY,KAAK,CAAC5B,QAAN,CAAeb,IAA3B,EACA4B,OAAO,CAACC,GAAR,CAAYY,KAAK,CAAC5B,QAAN,CAAe6B,MAA3B,EACAd,OAAO,CAACC,GAAR,CAAYY,KAAK,CAAC5B,QAAN,CAAe8B,OAA3B,EACA;AAAA;AACAL,mBAAmB,GACnBC,cAAc,CAAC,KAAD,CAAQ,0CAAR,CAAd,CACD,CATD,IASO,IAAIE,KAAK,CAACG,OAAV,CAAmB,CACxB;AACA;AACA;AACAhB,OAAO,CAACC,GAAR,CAAYY,KAAK,CAACG,OAAlB,EACAL,cAAc,CAAC,KAAD,CAAQ,0CAAR,CAAd,CACD,CANM,IAMA,CACL;AACAX,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBY,KAAK,CAACI,OAA3B,EACAN,cAAc,CAAC,KAAD,CAAQ,0CAAR,CAAd,CACD,CACF,CA3CH,EA4CD,CAhDG,EAiDHC,KAjDG,CAiDG,SAACM,GAAD,CAAS,CACdlB,OAAO,CAACC,GAAR,CAAYiB,GAAZ,EACD,CAnDG,CAPR,yCA2DSpB,WA3DT,0DAvU0B,qEAwY1B,GAAIqB,CAAAA,QAAQ,CAAGhL,WAAW,EAA1B,CAEA,QAASwK,CAAAA,cAAT,CAAwBS,YAAxB,CAAsCC,YAAtC,CAAoD,CAClD,GAAIC,CAAAA,UAAU,CAAG,iBAAmBjH,UAAU,CAACQ,cAA/C,CACAsG,QAAQ,CAACG,UAAD,CAAa,CACnBC,OAAO,CAAE,IADU,CAEnBC,KAAK,CAAE,CAAEC,OAAO,CAAEL,YAAX,CAAyBH,OAAO,CAAEI,YAAlC,CAFY,CAAb,CAAR,CAID,CAED;AACA,sBAAwCxL,KAAK,CAACC,QAAN,CAAe,KAAf,CAAxC,uDAAO4L,YAAP,sBAAqBC,eAArB,sBACA,GAAMjB,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,EAAM,CAChCiB,eAAe,CAAC,KAAD,CAAf,CACD,CAFD,CAGA,GAAMvH,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,EAAM,CACjCuH,eAAe,CAAC,CAACD,YAAF,CAAf,CACD,CAFD,CAIA,mBACE,yBACG/J,SAAS,cACR,YAAK,SAAS,CAAC,gBAAf,uBACE,KAAC,UAAD,wBACE,aAAM,SAAS,CAAC,iBAAhB,uBADF,EADF,EADQ,cAOR,wCACE,+CADF,cAEE,MAAC,aAAD,yBACE,KAAC,iBAAD,wBACE,KAAC,IAAD,EAAM,EAAE,CAAC,eAAT,yBADF,EADF,cAIE,KAAC,iBAAD,wBACE,MAAC,IAAD,EAAM,EAAE,CAAE,iBAAmBY,aAA7B,0BACeA,aADf,GADF,EAJF,cASE,KAAC,iBAAD,EAAmB,MAAM,KAAzB,oCATF,GAFF,cAaE,aAbF,cAcE,kCACE,MAAC,GAAD,EAAK,EAAE,CAAE,CAAEqJ,KAAK,CAAE,MAAT,CAAT,wBACE,KAAC,OAAD,EAAS,SAAS,CAAC,MAAnB,CAA0B,UAAU,CAAEnJ,UAAtC,UACGD,KAAK,CAACqJ,GAAN,CAAU,SAACC,KAAD,CAAQC,KAAR,CAAkB,CAC3B,GAAMC,CAAAA,SAAS,CAAG,EAAlB,CACA,GAAMC,CAAAA,UAAU,CAAG,EAAnB,CACA,GAAInJ,cAAc,CAACiJ,KAAD,CAAlB,CAA2B,CACzBE,UAAU,CAACC,QAAX,cACE,KAAC,UAAD,EAAY,OAAO,CAAC,SAApB,sBADF,CAGD,CACD,GAAIjJ,aAAa,CAAC8I,KAAD,CAAjB,CAA0B,CACxBC,SAAS,CAACG,SAAV,CAAsB,KAAtB,CACD,CACD,mBACE,KAAC,IAAD,gCAAsBH,SAAtB,4BACE,KAAC,SAAD,gCAAeC,UAAf,eAA4BH,KAA5B,GADF,GAAWA,KAAX,CADF,CAKD,CAhBA,CADH,EADF,CAoBGrJ,UAAU,GAAKD,KAAK,CAAC4J,MAArB,cACC,MAAC,KAAD,CAAO,QAAP,yBACE,KAAC,UAAD,EAAY,EAAE,CAAE,CAAEC,EAAE,CAAE,CAAN,CAASC,EAAE,CAAE,CAAb,CAAhB,mDADF,cAIE,MAAC,GAAD,EAAK,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAX,CAAmBC,aAAa,CAAE,KAAlC,CAAyCC,EAAE,CAAE,CAA7C,CAAT,wBACE,KAAC,GAAD,EAAK,EAAE,CAAE,CAAEC,IAAI,CAAE,UAAR,CAAT,EADF,cAEE,KAAC,MAAD,EAAQ,OAAO,CAAExI,WAAjB,6BAFF,GAJF,GADD,cAWC,KAAC,KAAD,CAAO,QAAP,WACGzB,UAAU,GAAK,CAAf,cACC,sCACE,KAAC,YAAD,wBACE,KAAC,iBAAD,SACE,UAAU,CAAE4B,UADd,CAEE,aAAa,CAAEjC,aAFjB,CAGE,WAAW,CAAEN,WAHf,CAIE,aAAa,CAAEgF,aAJjB,CAKE,iBAAiB,CAAEG,iBALrB,CAME,oBAAoB,CAAEC,oBANxB,CAOE,eAAe,CAAEE,eAPnB,CAQE,kBAAkB,CAAEC,kBARtB,CASE,iBAAiB,CAAEI,iBATrB,CAUE,uBAAuB,CAAEK,uBACzB;AAXF,CAYE,yBAAyB,CAAEtE,yBAZ7B,CAaE,4BAA4B,CAC1B8D,4BAEF;AAhBF,CAiBE,UAAU,CAAEzD,UAjBd,CAkBE,cAAc,CAAEf,cAlBlB,CAmBE,UAAU,CAAEL,UAnBd,CAoBE,UAAU,CAAEqB,UApBd,qCAqBcrB,UArBd,gCAsBSD,KAtBT,uCAuBgB2B,YAvBhB,qCAwBchB,UAxBd,SADF,EADF,EADD,CA+BGV,UAAU,GAAK,CAAf,cACF,sCACE,KAAC,YAAD,wBACE,KAAC,WAAD,SACE,UAAU,CAAE4B,UADd,CAEE,aAAa,CAAEyC,aAFjB,CAGE,iBAAiB,CAAEG,iBAHrB,CAIE,oBAAoB,CAAEC,oBAJxB,CAKE,eAAe,CAAEE,eALnB,CAME,kBAAkB,CAAEC,kBANtB,CAOE,iBAAiB,CAAEI,iBAPrB,CAQE,uBAAuB,CAAEK,uBACzB;AATF,CAUE,UAAU,CAAEjE,UAVd,CAWE,cAAc,CAAEf,cAXlB,CAYE,UAAU,CAAEL,UAZd,CAaE,UAAU,CAAEqB,UAbd,qCAccrB,UAdd,gCAeSD,KAfT,uCAgBgB2B,YAhBhB,qCAiBchB,UAjBd,SADF,EADF,EADE,CAwBAV,UAAU,GAAK,CAAf,cACF,sCACE,KAAC,YAAD,wBACE,KAAC,WAAD,SACE,UAAU,CAAE4B,UADd,CAEE,aAAa,CAAEyC,aAFjB,CAGE,iBAAiB,CAAEG,iBAHrB,CAIE,oBAAoB,CAAEC,oBAJxB,CAKE,eAAe,CAAEE,eALnB,CAME,kBAAkB,CAAEC,kBANtB,CAOE,iBAAiB,CAAEI,iBAPrB,CAQE,uBAAuB,CAAEK,uBACzB;AATF,CAUE,mBAAmB,CAAErE,mBAVvB,CAWE,sBAAsB,CAAE8D,sBACxB;AAZF,CAaE,UAAU,CAAE1D,UAbd,CAcE,cAAc,CAAEf,cAdlB,CAeE,UAAU,CAAEL,UAfd,CAgBE,UAAU,CAAEqB,UAhBd,qCAiBcrB,UAjBd,gCAkBSD,KAlBT,uCAmBgB2B,YAnBhB,qCAoBchB,UApBd,SADF,EADF,EADE,CA2BAV,UAAU,GAAK,CAAf,cACF,sCACE,KAAC,YAAD,wBACE,KAAC,cAAD,SACE,UAAU,CAAE4B,UADd,CAEE,aAAa,CAAEyC,aAFjB,CAGE,iBAAiB,CAAEG,iBAHrB,CAIE,oBAAoB,CAAEC,oBAJxB,CAKE,eAAe,CAAEE,eALnB,CAME,kBAAkB,CAAEC,kBANtB,CAOE,iBAAiB,CAAEI,iBAPrB,CAQE,uBAAuB,CAAEK,uBAR3B,CASE,eAAe,CAAEf,eATnB,CAUE,kBAAkB,CAAEC,kBAVtB,CAWE,mBAAmB,CAAEjF,mBAXvB,CAYE,WAAW,CAAEN,WAZf,CAaE,cAAc,CAAEC,cAChB;AAdF,CAeE,sBAAsB,CAAEgC,sBAf1B,CAgBE,yBAAyB,CAAE8D,yBAC3B;AAjBF,CAkBE,UAAU,CAAE3D,UAlBd,CAmBE,cAAc,CAAEf,cAnBlB,CAoBE,UAAU,CAAEL,UApBd,CAqBE,UAAU,CAAEqB,UArBd,qCAsBcrB,UAtBd,gCAuBSD,KAvBT,uCAwBgB2B,YAxBhB,qCAyBchB,UAzBd,SADF,EADF,EADE,cAiCF,sCACE,KAAC,YAAD,wBACE,KAAC,kBAAD,SACE,aAAa,CAAElB,aADjB,CAEE,SAAS,CAAEC,SACX;AAHF,CAIE,UAAU,CAAE2B,UAJd,CAKE,cAAc,CAAEf,cALlB,CAME,UAAU,CAAEL,UANd,CAOE,UAAU,CAAEqB,UAPd,qCAQcrB,UARd,gCASSD,KATT,uCAUgB2B,YAVhB,qCAWchB,UAXd,SADF,EADF,EApHJ,EA/BJ,GADF,EAdF,cAwLE,KAAC,QAAD,EACE,EAAE,CAAE,CAAEwJ,KAAK,CAAE,MAAT,CAAiBC,MAAM,CAAE,gBAACC,KAAD,QAAWA,CAAAA,KAAK,CAACD,MAAN,CAAaE,MAAb,CAAsB,CAAjC,EAAzB,CADN,CAEE,IAAI,CAAEpB,YAFR,CAGE,OAAO,CAAEhB,mBAHX,uBAKE,KAAC,gBAAD,EAAkB,KAAK,CAAC,SAAxB,EALF,EAxLF,GARJ,EADF,CA4MD,CAED,cAAenJ,CAAAA,WAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport useAxiosPrivate from \"../hooks/useAxiosPrivate\";\nimport { Link, useParams, useNavigate } from \"react-router-dom\";\nimport \"./css/LoadingSpinner.css\";\n\n// Unterformulare\nimport AllgemeineAngaben from \"../components/Declaration/AllgemeineAngaben\";\nimport Adressdaten from \"../components/Declaration/Adressdaten\";\nimport Lieferdaten from \"../components/Declaration/Lieferdaten\";\nimport Rechnungsdaten from \"../components/Declaration/Rechnungsdaten\";\nimport AnmeldungDokumente from \"../components/Declaration/AnmeldungDokumente\";\n\nimport {\n  MDBContainer,\n  MDBSpinner,\n  MDBBreadcrumb,\n  MDBBreadcrumbItem,\n} from \"mdb-react-ui-kit\";\n\n//Smart Contract\nimport { createZollanmeldung } from \"../Web3Client\";\n\n// Stepper\nimport Box from \"@mui/material/Box\";\nimport Stepper from \"@mui/material/Stepper\";\nimport Step from \"@mui/material/Step\";\nimport StepLabel from \"@mui/material/StepLabel\";\nimport Button from \"@mui/material/Button\";\nimport Typography from \"@mui/material/Typography\";\n\n// Loading Backdrop\nimport Backdrop from \"@mui/material/Backdrop\";\n\n//Nutzerdaten Abruf\nimport useAuth from \"../hooks/useAuth\";\nimport { CircularProgress } from \"@mui/material\";\n\nfunction Declaration(props) {\n  const [usedInvoice, setUsedInvoice] = useState();\n  const [isLoading, setIsLoading] = useState(true);\n  const [pubkeyCO, setPubkeyCO] = useState();\n  const [transactionInvoices, setTransactionInvoices] = useState();\n\n  //state für dokumente\n\n  const usedDocuments = [];\n  const [documents, setDocuments] = useState();\n\n  //auswahl für Zollämter\n\n  const [customOffices, setCustomOffices] = useState({});\n\n  //funktion für Nutzerdaten\n  const { auth } = useAuth();\n\n  //Abfrage der TransaktionsID\n\n  const { transactionId } = useParams();\n\n  // Stepper-Logik\n  const steps = [\n    \"Allgemeine Angaben\",\n    \"Adressdaten\",\n    \"Lieferdaten\",\n    \"Rechnungsdaten\",\n    \"Dokumente\",\n  ];\n\n  const [activeStep, setActiveStep] = React.useState(0);\n  const [skipped, setSkipped] = React.useState(new Set());\n\n  // (Kein Step ist optional)\n  const isStepOptional = (step) => {\n    return;\n  };\n\n  //Abfrage der voreingestellten Daten\n  const axiosInstance = useAxiosPrivate();\n\n  const isStepSkipped = (step) => {\n    return skipped.has(step);\n  };\n\n  const handleNext = (e) => {\n    let newSkipped = skipped;\n    if (isStepSkipped(activeStep)) {\n      newSkipped = new Set(newSkipped.values());\n      newSkipped.delete(activeStep);\n    }\n    // Check Validierung\n    if (activeStep === 0 && allgemeineAngabenValidity == false) {\n      return;\n    }\n    if (activeStep === 2 && lieferdatenValidity == false) {\n      return;\n    }\n    if (activeStep === 3 && rechnungsdatenValidity == false) {\n      return;\n    }\n    e.preventDefault();\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\n    setSkipped(newSkipped);\n  };\n\n  const handleBack = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\n  };\n\n  const handleSkip = () => {\n    if (!isStepOptional(activeStep)) {\n      // You probably want to guard against something like this,\n      // it should never occur unless someone's actively trying to break something.\n      throw new Error(\"You can't skip a step that isn't optional.\");\n    }\n\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\n    setSkipped((prevSkipped) => {\n      const newSkipped = new Set(prevSkipped.values());\n      newSkipped.add(activeStep);\n      return newSkipped;\n    });\n  };\n\n  const handleReset = () => {\n    setActiveStep(0);\n  };\n\n  //Übertragen der Daten\n  async function handleSubmit() {\n    // Backdrop Ladeanimation öffnen\n    handleToggleBackdrop();\n    const zollwert = (await fieldValue.gesamtbetrag) + fieldValue.lieferkosten;\n    await blockchainZollanmeldungTransaction(\n      pubkeyCO,\n      fieldValue.blockchainRID,\n      zollwert.toString(),\n      fieldValue.lieferbedingung\n    );\n\n    return;\n  }\n\n  // -- DATENFELDER --\n  // State des Inhalts der Felder\n  const [fieldValue, setFieldValue] = React.useState({\n    // Allgemeine Angaben\n    auftragsnummer: \"\",\n    bearbeitendeDienststelle: \"\",\n    anmeldungArt: \"\",\n    geschaeftArt: \"\",\n    zahlungArt: \"\",\n    // Adressdaten Versender\n    eoriVersender: \"\",\n    nameVersender: \"\",\n    vornameVersender: \"\",\n    firmaVersender: \"\",\n    strasseVersender: \"\",\n    plzVersender: \"\",\n    ortVersender: \"\",\n    staatVersender: \"\",\n    telefonVersender: \"\",\n    emailVersender: \"\",\n    // Adressdaten Anmelder\n    eoriAnmelder: \"\",\n    nameAnmelder: \"\",\n    vornameAnmelder: \"\",\n    firmaAnmelder: \"\",\n    strasseAnmelder: \"\",\n    plzAnmelder: \"\",\n    ortAnmelder: \"\",\n    staatAnmelder: \"\",\n    telefonAnmelder: \"\",\n    emailAnmelder: \"\",\n    // Lieferdaten\n    ausfuhrland: \"\",\n    bestimmungsland: \"\",\n    bestimmungsbundesland: \"\",\n    befoerderungsmittel: \"\",\n    lieferbedingung: \"\",\n    lieferort: \"\",\n    warenort: \"\",\n    lieferkosten: \"\",\n    //Rechnungsdaten\n    datumRechnung: \"\",\n    gesamtbetrag: \"\",\n    waehrung: \"\",\n  });\n\n  const [rechnungsposten, setRechnungsposten] = React.useState([{}]);\n\n  // Legacy State über fehlende Eingaben\n  // -> Keine manuelle Validierung mehr, sondern HTML5 Required-Validierung\n  const [inputMissingError, setInputMissingError] = React.useState({\n    // Allgemeine Angaben\n    auftragsnummer: false,\n    bearbeitendeDienststelle: false,\n    anmeldungArt: false,\n    geschaeftArt: false,\n    zahlungArt: false,\n    // Adressdaten Versender\n    eoriVersender: false,\n    nameVersender: false,\n    vornameVersender: false,\n    firmaVersender: false,\n    strasseVersender: false,\n    plzVersender: false,\n    ortVersender: false,\n    staatVersender: false,\n    telefonVersender: false,\n    emailVersender: false,\n    // Adressdaten Anmelder\n    eoriAnmelder: false,\n    nameAnmelder: false,\n    vornameAnmelder: false,\n    firmaAnmelder: false,\n    strasseAnmelder: false,\n    plzAnmelder: false,\n    ortAnmelder: false,\n    staatAnmelder: false,\n    telefonAnmelder: false,\n    emailAnmelder: false,\n    // Lieferdaten\n    ausfuhrland: false,\n    bestimmungsland: false,\n    bestimmungsbundesland: false,\n    befoerderungsmittel: false,\n    lieferbedingung: false,\n    lieferort: false,\n    warenort: false,\n    lieferkosten: false,\n    //Rechnungsdaten\n    datumRechnung: false,\n    gesamtbetrag: false,\n    waehrung: false,\n  });\n\n  // Legacy State über falsche Inputs (müssen Zahlen sein)\n  // -> Keine manuelle Validierung mehr, sondern HTML5 Required-Validierung\n  const [inputWrongError, setInputWrongError] = React.useState({\n    auftragsnummer: false,\n    eoriVersender: false,\n    plzVersender: false,\n    eoriAnmelder: false,\n    plsAnmelder: false,\n    lieferkosten: false,\n  });\n\n  // Neue Validierung-States\n  const [allgemeineAngabenValidity, setAllgemeineAngabenValidity] =\n    useState(false);\n  const [lieferdatenValidity, setLieferdatenValidity] = useState(false);\n  const [rechnungsdatenValidity, setRechnungsdatenValidity] = useState(false);\n\n  // FieldChange für Select und String-Felder\n  function handleFieldChange(event) {\n    const name = event.target.name;\n    const value = event.target.value;\n\n    setFieldValue({ ...fieldValue, [name]: value });\n    setInputMissingError({ ...inputMissingError, [name]: false });\n  }\n\n  // FieldChange für Zahlen-Inputfelder\n  function handleNumberFieldChange(event) {\n    const name = event.target.name;\n    const value = event.target.value;\n\n    // Validierung: nur Zahlen\n    if (isNaN(value)) {\n      setInputWrongError({ ...inputWrongError, [name]: true });\n    } else {\n      setInputWrongError({ ...inputWrongError, [name]: false });\n    }\n\n    setFieldValue({ ...fieldValue, [name]: value });\n    setInputMissingError({ ...inputMissingError, [name]: false });\n  }\n\n  // Abfragen der Bestandsdaten\n\n  useEffect(async () => {\n    await axiosInstance.get(`transactions/` + transactionId).then((res) => {\n      setFieldValue((prev) => {\n        return {\n          ...prev,\n          auftragsnummer: res.data.id,\n          eoriVersender: res.data.partnership.partner.eori_nr,\n          //nameVersender: .partnership.partner.name,\n          firmaVersender: res.data.partnership.partner.name,\n          strasseVersender: res.data.partnership.partner.street,\n          plzVersender: res.data.partnership.partner.city_code,\n          ortVersender: res.data.partnership.partner.city,\n          staatVersender: res.data.partnership.partner.country_code,\n          telefonVersender: res.data.partnership.partner.phone,\n          emailVersender: res.data.partnership.partner.email,\n          exporteur_pubkey: res.data.partnership.partner.publickey,\n        };\n      });\n      setIsLoading(false);\n    });\n\n    //Abfrage der eigenen Nutzerdaten\n\n    await axiosInstance.get(`user/`).then((response) => {\n      setFieldValue((prev) => {\n        return {\n          ...prev,\n          eoriAnmelder: response.data[0].employee?.company.eori_nr,\n          //nameVersender: .partnership.partner.name,\n          firmaAnmelder: response.data[0].employee.company.name,\n          strasseAnmelder: response.data[0].employee.company.street,\n          plzAnmelder: response.data[0].employee.company.city_code,\n          ortAnmelder: response.data[0].employee.company.city,\n          staatAnmelder: response.data[0].employee.company.country_code,\n          telefonAnmelder: response.data[0].employee.company.phone,\n          emailAnmelder: response.data[0].employee.company.email,\n        };\n      });\n    });\n\n    //Abfrage der Rechnungen für Auswahl\n\n    await axiosInstance\n      .get(`invoice/?transaction=${transactionId}`)\n      .then((response) => {\n        setTransactionInvoices(response.data);\n      });\n\n    //Abfrage der Zollstationen\n    await axiosInstance.get(\"customoffices/\").then((res) => {\n      setCustomOffices(res.data);\n      //setCompanies(res.data);\n    });\n    //Abfrage der Documente\n    await axiosInstance\n      .get(\"documents/?transaction=\" + transactionId)\n      .then((res) => {\n        setDocuments(res.data);\n        //setCompanies(res.data);\n      });\n  }, [transactionId]);\n\n  //Abfrage der Rechnungsdaten\n  useEffect(async () => {\n    if (typeof usedInvoice !== \"undefined\") {\n      await axiosInstance.get(`invoice/${usedInvoice}/`).then((response) => {\n        setFieldValue((prev) => {\n          return {\n            ...prev,\n            waehrung: response.data?.currency,\n            datumRechnung: response.data?.issue_date,\n            gesamtbetrag: response.data?.total_value,\n            lieferkosten: response.data?.transport_costs,\n            gesamtbetrag: response.data?.total_value,\n            blockchainRID: response.data?.blockchain_id,\n            rechnungID: response.data?.id,\n          };\n        });\n        setRechnungsposten(response.data?.invoiceItem);\n      });\n    }\n  }, [usedInvoice]);\n\n  // Blockchain Transaktion\n  async function blockchainZollanmeldungTransaction(\n    _zoll,\n    _rechnungID,\n    _zollwert,\n    _incoterms\n  ) {\n    var erfolgreich = false;\n    await createZollanmeldung(_zoll, _rechnungID, _zollwert, _incoterms)\n      .then((tx) => {\n        console.log(tx);\n        erfolgreich = true;\n        axiosInstance\n          .post(\"/declaration/\", {\n            anmeldeArt: fieldValue.anmeldungArt,\n            geschaeftArt: fieldValue.geschaeftArt,\n            zahlungsart: fieldValue?.zahlungArt,\n            ausfuhrland: fieldValue.ausfuhrland,\n            bestimmungsland: fieldValue.bestimmungsland,\n            befoerderungsmittel: fieldValue.befoerderungsmittel,\n            lieferbedingung: fieldValue.lieferbedingung,\n            lieferort: fieldValue.lieferort,\n            warenort: fieldValue?.warenort,\n            invoice: usedInvoice,\n            transaction: transactionId,\n            customs_office: fieldValue.bearbeitendeDienststelle,\n            blockchain_zid: tx - 1,\n            document: usedDocuments,\n          })\n          .then((res) => {\n            // Backdrop Ladeanimation schließen\n            handleCloseBackdrop();\n            handleNavigate(true, \"Zollanmeldung angelegt und übermittelt.\");\n          })\n          .catch(function (error) {\n            if (error.response) {\n              // The request was made and the server responded with a status code\n              // that falls out of the range of 2xx\n              console.log(error.response.data);\n              console.log(error.response.status);\n              console.log(error.response.headers);\n              // Backdrop Ladeanimation schließen\n              handleCloseBackdrop();\n              handleNavigate(false, \"Fehler bei Erstellung der Zollanmeldung.\");\n            } else if (error.request) {\n              // The request was made but no response was received\n              // `error.request` is an instance of XMLHttpRequest in the browser and an instance of\n              // http.ClientRequest in node.js\n              console.log(error.request);\n              handleNavigate(false, \"Fehler bei Erstellung der Zollanmeldung.\");\n            } else {\n              // Something happened in setting up the request that triggered an Error\n              console.log(\"Error\", error.message);\n              handleNavigate(false, \"Fehler bei Erstellung der Zollanmeldung.\");\n            }\n          });\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n    return erfolgreich;\n  }\n\n  // Navigation an DocumentsNew\n  //+ State: Informationen für Snackbar Alert\n\n  let navigate = useNavigate();\n\n  function handleNavigate(snackSuccess, snackMessage) {\n    let urladdress = \"/transactions/\" + fieldValue.auftragsnummer;\n    navigate(urladdress, {\n      replace: true,\n      state: { success: snackSuccess, message: snackMessage },\n    });\n  }\n\n  // -- Loading Backdrop --\n  const [openBackdrop, setOpenBackdrop] = React.useState(false);\n  const handleCloseBackdrop = () => {\n    setOpenBackdrop(false);\n  };\n  const handleToggleBackdrop = () => {\n    setOpenBackdrop(!openBackdrop);\n  };\n\n  return (\n    <>\n      {isLoading ? (\n        <div className=\"loadingSpinner\">\n          <MDBSpinner>\n            <span className=\"visually-hidden\">Lädt..</span>\n          </MDBSpinner>\n        </div>\n      ) : (\n        <>\n          <h3>Zollanmeldung erstellen</h3>\n          <MDBBreadcrumb>\n            <MDBBreadcrumbItem>\n              <Link to=\"/transactions\">Aufträge</Link>\n            </MDBBreadcrumbItem>\n            <MDBBreadcrumbItem>\n              <Link to={\"/transactions/\" + transactionId}>\n                Auftrags-ID {transactionId}\n              </Link>\n            </MDBBreadcrumbItem>\n            <MDBBreadcrumbItem active>Formular Zollanmeldung</MDBBreadcrumbItem>\n          </MDBBreadcrumb>\n          <br />\n          <div>\n            <Box sx={{ width: \"100%\" }}>\n              <Stepper className=\"mb-3\" activeStep={activeStep}>\n                {steps.map((label, index) => {\n                  const stepProps = {};\n                  const labelProps = {};\n                  if (isStepOptional(index)) {\n                    labelProps.optional = (\n                      <Typography variant=\"caption\">Optional</Typography>\n                    );\n                  }\n                  if (isStepSkipped(index)) {\n                    stepProps.completed = false;\n                  }\n                  return (\n                    <Step key={label} {...stepProps}>\n                      <StepLabel {...labelProps}>{label}</StepLabel>\n                    </Step>\n                  );\n                })}\n              </Stepper>\n              {activeStep === steps.length ? (\n                <React.Fragment>\n                  <Typography sx={{ mt: 2, mb: 1 }}>\n                    All steps completed - you&apos;re finished\n                  </Typography>\n                  <Box sx={{ display: \"flex\", flexDirection: \"row\", pt: 2 }}>\n                    <Box sx={{ flex: \"1 1 auto\" }} />\n                    <Button onClick={handleReset}>Zurücksetzen</Button>\n                  </Box>\n                </React.Fragment>\n              ) : (\n                <React.Fragment>\n                  {activeStep === 0 ? (\n                    <>\n                      <MDBContainer>\n                        <AllgemeineAngaben\n                          fieldValue={fieldValue}\n                          customOffices={customOffices}\n                          setPubkeyCO={setPubkeyCO}\n                          setFieldValue={setFieldValue}\n                          inputMissingError={inputMissingError}\n                          setInputMissingError={setInputMissingError}\n                          inputWrongError={inputWrongError}\n                          setInputWrongError={setInputWrongError}\n                          handleFieldChange={handleFieldChange}\n                          handleNumberFieldChange={handleNumberFieldChange}\n                          // Validierung State\n                          allgemeineAngabenValidity={allgemeineAngabenValidity}\n                          setAllgemeineAngabenValidity={\n                            setAllgemeineAngabenValidity\n                          }\n                          // Stepper Funktionen\n                          handleBack={handleBack}\n                          isStepOptional={isStepOptional}\n                          activeStep={activeStep}\n                          handleSkip={handleSkip}\n                          activeStep={activeStep}\n                          steps={steps}\n                          handleSubmit={handleSubmit}\n                          handleNext={handleNext}\n                        />\n                      </MDBContainer>\n                    </>\n                  ) : activeStep === 1 ? (\n                    <>\n                      <MDBContainer>\n                        <Adressdaten\n                          fieldValue={fieldValue}\n                          setFieldValue={setFieldValue}\n                          inputMissingError={inputMissingError}\n                          setInputMissingError={setInputMissingError}\n                          inputWrongError={inputWrongError}\n                          setInputWrongError={setInputWrongError}\n                          handleFieldChange={handleFieldChange}\n                          handleNumberFieldChange={handleNumberFieldChange}\n                          // Stepper Funktionen\n                          handleBack={handleBack}\n                          isStepOptional={isStepOptional}\n                          activeStep={activeStep}\n                          handleSkip={handleSkip}\n                          activeStep={activeStep}\n                          steps={steps}\n                          handleSubmit={handleSubmit}\n                          handleNext={handleNext}\n                        />\n                      </MDBContainer>\n                    </>\n                  ) : activeStep === 2 ? (\n                    <>\n                      <MDBContainer>\n                        <Lieferdaten\n                          fieldValue={fieldValue}\n                          setFieldValue={setFieldValue}\n                          inputMissingError={inputMissingError}\n                          setInputMissingError={setInputMissingError}\n                          inputWrongError={inputWrongError}\n                          setInputWrongError={setInputWrongError}\n                          handleFieldChange={handleFieldChange}\n                          handleNumberFieldChange={handleNumberFieldChange}\n                          // Validierung State\n                          lieferdatenValidity={lieferdatenValidity}\n                          setLieferdatenValidity={setLieferdatenValidity}\n                          // Stepper Funktionen\n                          handleBack={handleBack}\n                          isStepOptional={isStepOptional}\n                          activeStep={activeStep}\n                          handleSkip={handleSkip}\n                          activeStep={activeStep}\n                          steps={steps}\n                          handleSubmit={handleSubmit}\n                          handleNext={handleNext}\n                        />\n                      </MDBContainer>\n                    </>\n                  ) : activeStep === 3 ? (\n                    <>\n                      <MDBContainer>\n                        <Rechnungsdaten\n                          fieldValue={fieldValue}\n                          setFieldValue={setFieldValue}\n                          inputMissingError={inputMissingError}\n                          setInputMissingError={setInputMissingError}\n                          inputWrongError={inputWrongError}\n                          setInputWrongError={setInputWrongError}\n                          handleFieldChange={handleFieldChange}\n                          handleNumberFieldChange={handleNumberFieldChange}\n                          rechnungsposten={rechnungsposten}\n                          setRechnungsposten={setRechnungsposten}\n                          transactionInvoices={transactionInvoices}\n                          usedInvoice={usedInvoice}\n                          setUsedInvoice={setUsedInvoice}\n                          // Validierung State\n                          rechnungsdatenValidity={rechnungsdatenValidity}\n                          setRechnungsdatenValidity={setRechnungsdatenValidity}\n                          // Stepper Funktionen\n                          handleBack={handleBack}\n                          isStepOptional={isStepOptional}\n                          activeStep={activeStep}\n                          handleSkip={handleSkip}\n                          activeStep={activeStep}\n                          steps={steps}\n                          handleSubmit={handleSubmit}\n                          handleNext={handleNext}\n                        />\n                      </MDBContainer>\n                    </>\n                  ) : (\n                    <>\n                      <MDBContainer>\n                        <AnmeldungDokumente\n                          usedDocuments={usedDocuments}\n                          documents={documents}\n                          // Stepper Funktionen\n                          handleBack={handleBack}\n                          isStepOptional={isStepOptional}\n                          activeStep={activeStep}\n                          handleSkip={handleSkip}\n                          activeStep={activeStep}\n                          steps={steps}\n                          handleSubmit={handleSubmit}\n                          handleNext={handleNext}\n                        />\n                      </MDBContainer>\n                    </>\n                  )}\n                </React.Fragment>\n              )}\n            </Box>\n          </div>\n          <Backdrop\n            sx={{ color: \"#fff\", zIndex: (theme) => theme.zIndex.drawer + 1 }}\n            open={openBackdrop}\n            onClick={handleCloseBackdrop}\n          >\n            <CircularProgress color=\"inherit\" />\n          </Backdrop>\n        </>\n      )}\n    </>\n  );\n}\n\nexport default Declaration;\n"]},"metadata":{},"sourceType":"module"}